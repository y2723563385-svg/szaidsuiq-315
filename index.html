<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>启蒙星幼儿智能评估系统</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <style>
        /* 原有CSS样式保持不变 */
        :root {
            --primary: #3498db;
            --secondary: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --purple: #9b59b6;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gradient: linear-gradient(135deg, #3498db, #2ecc71);
            --gradient-alt: linear-gradient(135deg, #9b59b6, #3498db);
            --gradient-warm: linear-gradient(135deg, #ff9a9e, #fad0c4);
            --gradient-cool: linear-gradient(135deg, #a1c4fd, #c2e9fb);
        }
        
        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background-color: #f8f9fa;
            color: #333;
            transition: all 0.3s ease;
            overflow-x: hidden;
        }
        
        .navbar {
            background: var(--gradient);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 12px 0;
        }
        
        .card {
            border: none;
            border-radius: 16px;
            box-shadow: 0 6px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s, box-shadow 0.3s;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 25px rgba(0,0,0,0.15);
        }
        
        .card-header {
            background: var(--gradient);
            color: white;
            border-radius: 16px 16px 0 0 !important;
            font-weight: 600;
            padding: 15px 20px;
            font-size: 1.1rem;
        }
        
        .btn-primary {
            background: var(--primary);
            border: none;
            border-radius: 10px;
            padding: 12px 24px;
            transition: all 0.3s;
            font-weight: 500;
            box-shadow: 0 4px 6px rgba(52, 152, 219, 0.3);
        }
        
        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .login-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            overflow: hidden;
            transform: translateY(0);
            transition: transform 0.5s ease;
            margin-top: 400px; /* 新增：增加上边距使登录框下移 */
        }
        
        .login-container:hover {
            transform: translateY(-5px);
        }
        
        .login-header {
            background: var(--gradient);
            color: white;
            padding: 40px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .login-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            animation: rotate 15s linear infinite;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .stats-card {
            text-align: center;
            padding: 25px 15px;
            border-radius: 16px;
            color: white;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            transition: all 0.4s;
        }
        
        .stats-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 50%);
            z-index: 1;
        }
        
        .stats-card.primary {
            background: var(--gradient);
        }
        
        .stats-card.success {
            background: var(--gradient-alt);
        }
        
        .stats-card.warning {
            background: var(--gradient-warm);
        }
        
        .stats-card.danger {
            background: var(--gradient-cool);
        }
        
        .stats-card.purple {
            background: linear-gradient(135deg, #9b59b6, #e74c3c);
        }
        
        .stats-number {
            font-size: 2.8rem;
            font-weight: 700;
            margin: 15px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .child-card {
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .child-card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }
        
        .radar-chart-container {
            position: relative;
            height: 300px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 16px;
            padding: 20px;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.05);
        }
        
        /* 管理员功能样式 */
        .admin-controls {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        .user-management-card {
            border-left: 5px solid #3498db;
        }
        
        .child-management-card {
            border-left: 5px solid #2ecc71;
        }
        
        .parent-management-card {
            border-left: 5px solid #f39c12;
        }
        
        .class-management-card {
            border-left: 5px solid #9b59b6;
        }
        
        /* 家长界面样式 */
        .parent-dashboard {
            background: linear-gradient(135deg, #3498db, #2ecc71);
            color: white;
            padding: 40px 30px;
            border-radius: 20px;
            margin-bottom: 25px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }
        
        .parent-dashboard::before {
            content: '';
            position: absolute;
            top: -20px;
            right: -20px;
            width: 150px;
            height: 150px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
        }
        
        .parent-dashboard::after {
            content: '';
            position: absolute;
            bottom: -30px;
            left: -30px;
            width: 200px;
            height: 200px;
            background: rgba(255,255,255,0.05);
            border-radius: 50%;
        }
        
        /* 预警列表样式 */
        .warning-item {
            border-left: 5px solid #e74c3c;
            padding-left: 20px;
            margin-bottom: 15px;
            background-color: #fdf2f2;
            padding: 18px;
            border-radius: 12px;
            transition: all 0.3s;
        }
        
        .warning-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.2);
        }
        
        .tab-content {
            padding: 25px 0;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .nav-tabs .nav-link {
            border: none;
            color: var(--dark);
            font-weight: 500;
            padding: 12px 24px;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s;
            margin-right: 5px;
        }
        
        .nav-tabs .nav-link.active {
            background: var(--gradient);
            color: white;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .nav-tabs .nav-link:hover:not(.active) {
            background: rgba(52, 152, 219, 0.1);
            border-radius: 10px;
        }
        
        .table-hover tbody tr:hover {
            background-color: rgba(52, 152, 219, 0.1);
            transform: scale(1.01);
            transition: all 0.2s;
        }
        
        .warning-badge {
            background: var(--danger);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .progress {
            height: 12px;
            border-radius: 10px;
            margin: 8px 0;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
        }
        
        .development-level {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .level-excellent {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
            box-shadow: 0 2px 4px rgba(21, 87, 36, 0.2);
        }
        
        .level-good {
            background: linear-gradient(135deg, #d1ecf1, #bee5eb);
            color: #0c5460;
            box-shadow: 0 2px 4px rgba(12, 84, 96, 0.2);
        }
        
        .level-medium {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            color: #856404;
            box-shadow: 0 2px 4px rgba(133, 100, 4, 0.2);
        }
        
        .level-need-improvement {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            color: #721c24;
            box-shadow: 0 2px 4px rgba(114, 28, 36, 0.2);
        }
        
        .level-need-attention {
            background: linear-gradient(135deg, #e2e3e5, #d6d8db);
            color: #383d41;
            box-shadow: 0 2px 4px rgba(56, 61, 65, 0.2);
        }
        
        .floating-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 100;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: all 0.3s;
        }
        
        .floating-btn:hover {
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }
        
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        
        .dark-mode {
            background-color: #1a1a2e;
            color: #e6e6e6;
        }
        
        .dark-mode .card {
            background-color: #16213e;
            color: #e6e6e6;
            border: 1px solid #2a2a4a;
        }
        
        .dark-mode .table {
            color: #e6e6e6;
        }
        
        .dark-mode .table-hover tbody tr:hover {
            background-color: rgba(52, 152, 219, 0.2);
            color: #e6e6e6;
        }
        
        .dark-mode .modal-content {
            background-color: #16213e;
            color: #e6e6e6;
        }
        
        .dark-mode .form-control {
            background-color: #1a1a2e;
            color: #e6e6e6;
            border-color: #2a2a4a;
        }
        
        .dark-mode .form-control:focus {
            background-color: #1a1a2e;
            color: #e6e6e6;
            border-color: var(--primary);
            box-shadow: 0 0 0 0.25rem rgba(52, 152, 219, 0.25);
        }
        
        .dark-mode .list-group-item {
            background-color: #16213e;
            color: #e6e6e6;
            border-color: #2a2a4a;
        }
        
        .dark-mode .list-group-item:hover {
            background-color: #1a1a2e;
            color: #e6e6e6;
        }
        
        .dark-mode .list-group-item.active {
            background-color: var(--primary);
            border-color: var(--primary);
        }
        
        .dark-mode .text-muted {
            color: #a0a0a0 !important;
        }
        
        .dark-mode .btn-outline-primary {
            color: var(--primary);
            border-color: var(--primary);
        }
        
        .dark-mode .btn-outline-primary:hover {
            background-color: var(--primary);
            color: white;
        }
        
        .dark-mode .btn-outline-secondary {
            color: #a0a0a0;
            border-color: #a0a0a0;
        }
        
        .dark-mode .btn-outline-secondary:hover {
            background-color: #a0a0a0;
            color: #16213e;
        }
        
        .dark-mode .btn-outline-success {
            color: var(--secondary);
            border-color: var(--secondary);
        }
        
        .dark-mode .btn-outline-success:hover {
            background-color: var(--secondary);
            color: white;
        }
        
        .dark-mode .btn-outline-warning {
            color: var(--warning);
            border-color: var(--warning);
        }
        
        .dark-mode .btn-outline-warning:hover {
            background-color: var(--warning);
            color: white;
        }
        
        .dark-mode .btn-outline-info {
            color: var(--primary);
            border-color: var(--primary);
        }
        
        .dark-mode .btn-outline-info:hover {
            background-color: var(--primary);
            color: white;
        }
        
        .dark-mode .btn-outline-danger {
            color: var(--danger);
            border-color: var(--danger);
        }
        
        .dark-mode .btn-outline-danger:hover {
            background-color: var(--danger);
            color: white;
        }
        
        .dark-mode .forum-post {
            border-left-color: var(--primary);
        }
        
        .dark-mode .forum-post:hover {
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .dark-mode .activity-item {
            background-color: rgba(52, 152, 219, 0.05);
        }
        
        .dark-mode .activity-item:hover {
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .dark-mode .resource-card {
            border-color: #2a2a4a;
        }
        
        .dark-mode .resource-card:hover {
            border-color: var(--primary);
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s;
        }
        
        .printable-report {
            background: white;
            color: black;
            padding: 30px;
            border-radius: 12px;
        }
        
        .logo-img {
            width: 45px;
            height: 45px;
            margin-right: 12px;
            border-radius: 10px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }
        
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1050;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transform: translateX(200%);
            transition: transform 0.4s ease;
            max-width: 350px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }
        
        .notification.error {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        
        .notification.info {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        .floating-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-12px); }
            100% { transform: translateY(0px); }
        }
        
        .typing-effect {
            overflow: hidden;
            white-space: nowrap;
            margin: 0 auto;
            letter-spacing: .15em;
            animation: typing 3.5s steps(40, end);
        }
        
        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }
        
        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: var(--primary); }
        }
        
        .test-account {
            cursor: pointer;
            padding: 10px 15px;
            border-radius: 10px;
            transition: all 0.3s;
            margin-bottom: 8px;
            border: 1px solid #e9ecef;
            background: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .test-account:hover {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            transform: translateX(5px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .test-account i {
            color: var(--primary);
            font-size: 1.2rem;
            transition: transform 0.3s;
        }
        
        .test-account:hover i {
            transform: scale(1.2);
        }
        
        .forum-post {
            border-left: 5px solid var(--primary);
            padding-left: 20px;
            margin-bottom: 25px;
            transition: all 0.3s;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        }
        
        .forum-post:hover {
            background-color: rgba(52, 152, 219, 0.05);
            transform: translateX(5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.1);
        }
        
        .avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 12px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }
        
        .activity-item {
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 12px;
            background-color: rgba(52, 152, 219, 0.05);
            transition: all 0.3s;
            border-left: 4px solid var(--primary);
        }
        
        .activity-item:hover {
            background-color: rgba(52, 152, 219, 0.1);
            transform: translateX(5px);
        }
        
        .resource-card {
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s;
            background: white;
            height: 100%;
            cursor: pointer; /* 新增：使资源卡片可点击 */
        }
        
        .resource-card:hover {
            border-color: var(--primary);
            transform: translateY(-8px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .glow-effect {
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.3);
        }
        
        .pulse-glow {
            animation: pulse-glow 2s infinite;
        }
        
        @keyframes pulse-glow {
            0% { box-shadow: 0 0 5px rgba(52, 152, 219, 0.3); }
            50% { box-shadow: 0 0 20px rgba(52, 152, 219, 0.6); }
            100% { box-shadow: 0 0 5px rgba(52, 152, 219, 0.3); }
        }
        
        .dashboard-welcome {
            background: var(--gradient-alt);
            color: white;
            padding: 40px 30px;
            border-radius: 20px;
            margin-bottom: 25px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }
        
        .dashboard-welcome::before {
            content: '';
            position: absolute;
            top: -30px;
            right: -30px;
            width: 200px;
            height: 200px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
        }
        
        .login-help {
            margin-top: 25px;
            border-top: 1px solid #eee;
            padding-top: 25px;
        }
        
        .dark-mode .login-help {
            border-top-color: #2a2a4a;
        }
        
        .class-chart-legend {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 15px;
        }
        
        .class-chart-legend-item {
            display: flex;
            align-items: center;
            margin: 8px 12px;
        }
        
        .class-chart-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        /* 新增样式 */
        .bounce-in {
            animation: bounceIn 0.6s ease;
        }
        
        @keyframes bounceIn {
            0% { transform: scale(0.5); opacity: 0; }
            70% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .slide-in-left {
            animation: slideInLeft 0.5s ease;
        }
        
        @keyframes slideInLeft {
            from { transform: translateX(-50px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .slide-in-right {
            animation: slideInRight 0.5s ease;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(50px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .zoom-in {
            animation: zoomIn 0.5s ease;
        }
        
        @keyframes zoomIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .gradient-text {
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 700;
        }
        
        .hover-lift {
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .hover-lift:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .shimmer {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .ripple {
            position: relative;
            overflow: hidden;
        }
        
        .ripple:after {
            content: "";
            display: block;
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            background-image: radial-gradient(circle, #fff 10%, transparent 10.01%);
            background-repeat: no-repeat;
            background-position: 50%;
            transform: scale(10, 10);
            opacity: 0;
            transition: transform .5s, opacity 1s;
        }
        
        .ripple:active:after {
            transform: scale(0, 0);
            opacity: .2;
            transition: 0s;
        }
        
        .wave {
            position: relative;
        }
        
        .wave:before {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 10px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" fill="%23ffffff"></path></svg>');
            background-size: 1200px 100px;
            animation: wave 10s linear infinite;
        }
        
        @keyframes wave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1200px; }
        }
        
        .parallax {
            background-attachment: fixed;
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
        }
        
        .text-shadow {
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .btn-gradient {
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px 24px;
            transition: all 0.3s;
            font-weight: 500;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .btn-gradient:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .input-glow:focus {
            box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
            border-color: #3498db;
        }
        
        .card-glow {
            box-shadow: 0 0 20px rgba(52, 152, 219, 0.2);
        }
        
        .pulse-soft {
            animation: pulseSoft 3s infinite;
        }
        
        @keyframes pulseSoft {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        .rotate {
            animation: rotate 10s linear infinite;
        }
        
        .admin-action-btn {
            margin: 5px;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .admin-action-btn:hover {
            transform: scale(1.05);
        }
        
        .class-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            margin: 2px;
        }
        
        .class-badge.primary {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
        }
        
        .class-badge.success {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
        }
        
        .class-badge.warning {
            background: rgba(243, 156, 18, 0.2);
            color: #f39c12;
        }
        
        .class-badge.danger {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }
        
        /* 新增教育资源样式 */
        .resource-category {
            margin-bottom: 30px;
        }
        
        .resource-category-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .resource-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .resource-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: all 0.3s;
            border-left: 4px solid var(--primary);
            cursor: pointer; /* 新增：使资源项可点击 */
        }
        
        .resource-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }
        
        .resource-icon {
            font-size: 2rem;
            margin-bottom: 15px;
            color: var(--primary);
        }
        
        .resource-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .resource-description {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .resource-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: #888;
        }
        
        .resource-tag {
            display: inline-block;
            background: rgba(52, 152, 219, 0.1);
            color: var(--primary);
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            margin-right: 5px;
        }
        
        .resource-featured {
            border: 2px solid var(--warning);
            position: relative;
        }
        
        .resource-featured-badge {
            position: absolute;
            top: -10px;
            right: 10px;
            background: var(--warning);
            color: white;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .resource-search {
            margin-bottom: 30px;
        }
        
        .resource-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        
        .resource-stat-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            flex: 1;
            margin: 0 10px;
        }
        
        .resource-stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .resource-stat-label {
            font-size: 0.9rem;
            color: #666;
        }
        
        /* 新增资源下载和评分样式 */
        .resource-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }
        
        .resource-download-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 6px 12px;
            font-size: 0.85rem;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .resource-download-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        .resource-rating {
            display: flex;
            align-items: center;
        }
        
        .star {
            color: #ddd;
            cursor: pointer;
            transition: color 0.3s;
            margin-left: 2px;
        }
        
        .star.active {
            color: #f39c12;
        }
        
        .star:hover {
            color: #f39c12;
        }
        
        /* 新增：登录界面右侧内容对齐样式 */
        .login-help .row {
            margin-left: 0;
            margin-right: 0;
        }
        
        .login-help .col-md-6 {
            padding-left: 0;
            padding-right: 0;
        }
        
        .login-help .test-account {
            margin-left: 0;
            margin-right: 0;
        }
    </style>
</head>
<body>
    <!-- 通知区域 -->
    <div id="notification-area"></div>

    <!-- 登录页面 -->
    <div id="login-page" class="container-fluid vh-100 d-flex align-items-center justify-content-center">
        <div class="row w-100">
            <div class="col-md-6 mx-auto">
                <div class="login-container">
                    <div class="login-header">
                        <h1 class="text-shadow"><i class="fas fa-star me-2"></i>启蒙星幼儿智能评估系统</h1>
                        <p class="mb-0">基于数据驱动的幼儿发育评估与监测平台</p>
                    </div>
                    <div class="p-5">
                        <div class="mb-4">
                            <label for="username" class="form-label">用户名</label>
                            <input type="text" class="form-control input-glow" id="username" placeholder="请输入用户名">
                        </div>
                        <div class="mb-4">
                            <label for="password" class="form-label">密码</label>
                            <input type="password" class="form-control input-glow" id="password" placeholder="请输入密码">
                        </div>
                        <button id="login-btn" class="btn btn-gradient w-100 py-2 mb-3 ripple">
                            <span id="login-text">登录</span>
                            <span id="login-spinner" class="loading-spinner d-none"></span>
                        </button>
                        
                        <div class="login-help">
                            <h6 class="mb-3">测试账号信息 (点击账号自动填充)</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <p><strong>教师账号:</strong></p>
                                    <div class="test-account" data-username="teacher1" data-password="123456">
                                        <span>teacher1/123456 (新生班)</span>
                                        <i class="fas fa-mouse-pointer"></i>
                                    </div>
                                    <div class="test-account" data-username="teacher2" data-password="123456">
                                        <span>teacher2/123456 (中一班)</span>
                                        <i class="fas fa-mouse-pointer"></i>
                                    </div>
                                    <div class="test-account" data-username="teacher3" data-password="123456">
                                        <span>teacher3/123456 (中二班)</span>
                                        <i class="fas fa-mouse-pointer"></i>
                                    </div>
                                    <div class="test-account" data-username="teacher4" data-password="123456">
                                        <span>teacher4/123456 (大二班)</span>
                                        <i class="fas fa-mouse-pointer"></i>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <p class="invisible">占位</p>
                                    <div class="test-account" data-username="teacher5" data-password="123456">
                                        <span>teacher5/123456 (大一班)</span>
                                        <i class="fas fa-mouse-pointer"></i>
                                    </div>
                                    <div class="test-account" data-username="teacher6" data-password="123456">
                                        <span>teacher6/123456 (月亮二班)</span>
                                        <i class="fas fa-mouse-pointer"></i>
                                    </div>
                                    <div class="test-account" data-username="teacher7" data-password="123456">
                                        <span>teacher7/123456 (月亮三班)</span>
                                        <i class="fas fa-mouse-pointer"></i>
                                    </div>
                                    <div class="test-account" data-username="teacher8" data-password="123456">
                                        <span>teacher8/123456 (桔子二班)</span>
                                        <i class="fas fa-mouse-pointer"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-2">
                                <div class="col-md-6">
                                    <p><strong>园长账号:</strong></p>
                                    <div class="test-account" data-username="principal" data-password="123456">
                                        <span>principal/123456</span>
                                        <i class="fas fa-mouse-pointer"></i>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <p><strong>管理员账号:</strong></p>
                                    <div class="test-account" data-username="admin" data-password="123456">
                                        <span>admin/123456</span>
                                        <i class="fas fa-mouse-pointer"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-2">
                                <div class="col-12">
                                    <p><strong>家长账号:</strong></p>
                                    <div class="test-account" data-username="yljz" data-password="123456">
                                        <span>yljz/123456 (杨珞恒家长)</span>
                                        <i class="fas fa-mouse-pointer"></i>
                                    </div>
                                    <div class="test-account" data-username="ghcjz" data-password="123456">
                                        <span>ghcjz/123456 (高浩晨家长)</span>
                                        <i class="fas fa-mouse-pointer"></i>
                                    </div>
                                    <div class="test-account" data-username="tjyjz" data-password="123456">
                                        <span>tjyjz/123456 (谈景阳家长)</span>
                                        <i class="fas fa-mouse-pointer"></i>
                                    </div>
                                    <div class="test-account" data-username="bzqjz" data-password="123456">
                                        <span>bzqjz/123456 (白志强家长)</span>
                                        <i class="fas fa-mouse-pointer"></i>
                                    </div>
                                    <div class="test-account" data-username="ayjz" data-password="123456">
                                        <span>ayjz/123456 (杨安亿家长)</span>
                                        <i class="fas fa-mouse-pointer"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 主应用页面 -->
    <div id="main-app" class="d-none">
        <!-- 导航栏 -->
        <nav class="navbar navbar-expand-lg navbar-dark">
            <div class="container">
                <a class="navbar-brand" href="#">
                    <!-- 修改：使用项目中的图片替换问号图标 -->
                    <img src="https://img.icons8.com/color/48/000000/children.png" class="logo-img" alt="启蒙星">
                    启蒙星幼儿智能评估系统
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" data-tab="dashboard">仪表盘</a>
                        </li>
                        <li class="nav-item" id="children-nav">
                            <a class="nav-link" href="#" data-tab="children">幼儿管理</a>
                        </li>
                        <li class="nav-item" id="assessment-nav">
                            <a class="nav-link" href="#" data-tab="assessment">发育评估</a>
                        </li>
                        <li class="nav-item" id="reports-nav">
                            <a class="nav-link" href="#" data-tab="reports">报告生成</a>
                        </li>
                        <li class="nav-item" id="analytics-nav">
                            <a class="nav-link" href="#" data-tab="analytics">统计分析</a>
                        </li>
                        <li class="nav-item" id="resources-nav">
                            <a class="nav-link" href="#" data-tab="resources">教育资源</a>
                        </li>
                        <li class="nav-item" id="forum-nav">
                            <a class="nav-link" href="#" data-tab="forum">幼教论坛</a>
                        </li>
                        <li class="nav-item d-none" id="admin-nav">
                            <a class="nav-link" href="#" data-tab="admin">系统管理</a>
                        </li>
                    </ul>
                    <div class="d-flex align-items-center">
                        <span class="navbar-text me-3" id="user-info">欢迎，用户</span>
                        <button class="btn btn-outline-light btn-sm ripple" id="logout-btn">
                            <i class="fas fa-sign-out-alt me-1"></i>退出登录
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- 主内容区 -->
        <div class="container mt-4">
            <!-- 仪表盘 -->
            <div id="dashboard-tab" class="tab-content">
                <!-- 家长专用仪表盘 -->
                <div id="parent-dashboard" class="d-none">
                    <div class="parent-dashboard">
                        <h2 id="parent-welcome-message" class="text-shadow">欢迎使用启蒙星幼儿智能评估系统</h2>
                        <p class="mb-0">您可以在这里查看您孩子的发育评估情况</p>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="card card-glow">
                                <div class="card-header">孩子信息</div>
                                <div class="card-body" id="parent-child-info">
                                    <!-- 孩子信息将通过JS动态生成 -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-8">
                            <div class="card card-glow">
                                <div class="card-header">能力雷达图</div>
                                <div class="card-body">
                                    <div class="radar-chart-container">
                                        <canvas id="parent-radar-chart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card card-glow">
                                <div class="card-header">发育水平</div>
                                <div class="card-body" id="parent-development-level">
                                    <!-- 发育水平将通过JS动态生成 -->
                                </div>
                            </div>
                            
                            <div class="card card-glow mt-4">
                                <div class="card-header">教育建议</div>
                                <div class="card-body" id="parent-suggestions">
                                    <!-- 教育建议将通过JS动态生成 -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 教师/管理员仪表盘 -->
                <div id="teacher-dashboard">
                    <div class="dashboard-welcome">
                        <h2 id="welcome-message" class="text-shadow">欢迎使用启蒙星幼儿智能评估系统</h2>
                        <p class="mb-0">我们致力于为幼儿提供科学、全面的发育评估与个性化指导</p>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="stats-card primary pulse-glow">
                                <i class="fas fa-baby fa-2x floating-animation"></i>
                                <div class="stats-number" id="total-children">0</div>
                                <div>总幼儿数</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-card success pulse-glow">
                                <i class="fas fa-school fa-2x floating-animation"></i>
                                <div class="stats-number" id="total-classes">0</div>
                                <div>班级数量</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-card warning pulse-glow">
                                <i class="fas fa-chart-line fa-2x floating-animation"></i>
                                <div class="stats-number" id="total-assessments">0</div>
                                <div>评估记录</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-card danger pulse-glow">
                                <i class="fas fa-exclamation-triangle fa-2x floating-animation"></i>
                                <div class="stats-number" id="warning-count">0</div>
                                <div>预警人数</div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-8">
                            <div class="card card-glow">
                                <div class="card-header">发育趋势分析</div>
                                <div class="card-body">
                                    <canvas id="development-trend-chart" height="300"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card card-glow">
                                <div class="card-header">班级分布</div>
                                <div class="card-body">
                                    <canvas id="class-distribution-chart" height="300"></canvas>
                                    <div class="class-chart-legend" id="class-chart-legend">
                                        <!-- 图例将通过JS动态生成 -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card card-glow">
                                <div class="card-header">近期预警幼儿</div>
                                <div class="card-body">
                                    <div id="warning-list" class="table-responsive">
                                        <!-- 预警列表将通过JS动态生成 -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mt-4">
                        <div class="col-md-6">
                            <div class="card card-glow">
                                <div class="card-header">最新动态</div>
                                <div class="card-body">
                                    <div id="recent-activities">
                                        <!-- 动态内容将通过JS动态生成 -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card card-glow">
                                <div class="card-header">快速操作</div>
                                <div class="card-body">
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-outline-primary ripple" onclick="switchTab('assessment')">
                                            <i class="fas fa-chart-bar me-2"></i>进行发育评估
                                        </button>
                                        <button class="btn btn-outline-success ripple" onclick="switchTab('reports')">
                                            <i class="fas fa-file-alt me-2"></i>生成评估报告
                                        </button>
                                        <button class="btn btn-outline-info ripple" onclick="switchTab('resources')">
                                            <i class="fas fa-book me-2"></i>浏览教育资源
                                        </button>
                                        <button class="btn btn-outline-warning ripple" onclick="switchTab('forum')">
                                            <i class="fas fa-users me-2"></i>参与论坛讨论
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 幼儿管理 -->
            <div id="children-tab" class="tab-content d-none">
                <div class="card card-glow">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <span>幼儿列表</span>
                        <div class="d-flex">
                            <select class="form-select me-2 input-glow" id="class-filter">
                                <option value="all">所有班级</option>
                                <!-- 班级选项将通过JS动态生成 -->
                            </select>
                            <button class="btn btn-gradient ripple" id="add-child-btn">
                                <i class="fas fa-plus me-1"></i>添加幼儿
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover" id="children-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>姓名</th>
                                        <th>性别</th>
                                        <th>月龄</th>
                                        <th>班级</th>
                                        <th>发育商</th>
                                        <th>发育水平</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- 幼儿数据将通过JS动态生成 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 发育评估 -->
            <div id="assessment-tab" class="tab-content d-none">
                <div class="row">
                    <div class="col-md-4">
                        <div class="card card-glow">
                            <div class="card-header">选择幼儿</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">选择班级</label>
                                    <!-- 修改：添加"请选择班级"选项 -->
                                    <select class="form-select input-glow" id="assessment-class-select">
                                        <option value="">请选择班级</option>
                                        <!-- 班级选项将通过JS动态生成 -->
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">选择幼儿</label>
                                    <select class="form-select input-glow" id="assessment-child-select">
                                        <option value="">请先选择班级</option>
                                    </select>
                                </div>
                                <button class="btn btn-gradient w-100 ripple" id="load-assessment-btn">
                                    <i class="fas fa-chart-bar me-1"></i>加载评估数据
                                </button>
                            </div>
                        </div>
                        
                        <div class="card card-glow mt-4">
                            <div class="card-header">评估详情</div>
                            <div class="card-body">
                                <div id="assessment-details">
                                    <!-- 评估详情将通过JS动态生成 -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-8">
                        <div class="card card-glow">
                            <div class="card-header">能力雷达图</div>
                            <div class="card-body">
                                <div class="radar-chart-container">
                                    <canvas id="radar-chart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card card-glow mt-4">
                            <div class="card-header">发育趋势</div>
                            <div class="card-body">
                                <canvas id="development-progress-chart" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 报告生成 -->
            <div id="reports-tab" class="tab-content d-none">
                <div class="row">
                    <div class="col-md-4">
                        <div class="card card-glow">
                            <div class="card-header">报告设置</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">选择幼儿</label>
                                    <select class="form-select input-glow" id="report-child-select">
                                        <option value="">请选择幼儿</option>
                                        <!-- 幼儿选项将通过JS动态生成 -->
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">报告类型</label>
                                    <select class="form-select input-glow" id="report-type">
                                        <option value="text">文本报告</option>
                                        <option value="radar">能力雷达图</option>
                                        <option value="comprehensive">综合报告</option>
                                    </select>
                                </div>
                                <button class="btn btn-gradient w-100 mb-2 ripple" id="generate-report-btn">
                                    <i class="fas fa-file-alt me-1"></i>生成报告
                                </button>
                                <button class="btn btn-success w-100 ripple" id="download-report-btn">
                                    <i class="fas fa-download me-1"></i>下载报告
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-8">
                        <div class="card card-glow">
                            <div class="card-header">报告预览</div>
                            <div class="card-body">
                                <div id="report-preview" class="p-3 border rounded" style="min-height: 500px;">
                                    <!-- 报告内容将通过JS动态生成 -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 统计分析 -->
            <div id="analytics-tab" class="tab-content d-none">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card card-glow">
                            <div class="card-header">班级对比分析</div>
                            <div class="card-body">
                                <canvas id="class-comparison-chart" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card card-glow">
                            <div class="card-header">能力领域分布</div>
                            <div class="card-body">
                                <canvas id="domain-distribution-chart" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="card card-glow">
                            <div class="card-header">发育预警分析</div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="warning-analysis-table">
                                        <thead>
                                            <tr>
                                                <th>姓名</th>
                                                <th>班级</th>
                                                <th>月龄</th>
                                                <th>发育商</th>
                                                <th>发育水平</th>
                                                <th>薄弱领域</th>
                                                <th>建议措施</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- 预警分析数据将通过JS动态生成 -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 教育资源 -->
            <div id="resources-tab" class="tab-content d-none">
                <div class="resource-search">
                    <div class="row">
                        <div class="col-md-8">
                            <div class="input-group">
                                <input type="text" class="form-control input-glow" placeholder="搜索教育资源...">
                                <button class="btn btn-gradient"><i class="fas fa-search"></i> 搜索</button>
                            </div>
                        </div>
                        <div class="col-md-4">
        <select class="form-select" id="resource-category-filter">
        <option value="all">所有分类</option>
    </select>
</div>
                    </div>
                </div>
                
                <div class="resource-stats">
                    <div class="resource-stat-item">
                        <div class="resource-stat-number">156</div>
                        <div class="resource-stat-label">教育资源总数</div>
                    </div>
                    <div class="resource-stat-item">
                        <div class="resource-stat-number">23</div>
                        <div class="resource-stat-label">本月新增</div>
                    </div>
                    <div class="resource-stat-item">
                        <div class="resource-stat-number">4.8</div>
                        <div class="resource-stat-label">平均评分</div>
                    </div>
                    <div class="resource-stat-item">
                        <div class="resource-stat-number">1,245</div>
                        <div class="resource-stat-label">下载次数</div>
                    </div>
                </div>
                
                <div class="resource-category">
                    <h3 class="resource-category-title"><i class="fas fa-star me-2"></i>精选推荐</h3>
                    <div class="resource-grid">
                        <div class="resource-item resource-featured">
                            <div class="resource-featured-badge">推荐</div>
                            <div class="resource-icon"><i class="fas fa-book"></i></div>
                            <div class="resource-title">幼儿发展里程碑指南</div>
                            <div class="resource-description">全面介绍0-6岁幼儿各阶段发展特点，包含详细的评估标准和观察要点，帮助教师科学评估幼儿发展水平。</div>
                            <div class="resource-actions">
                                <button class="resource-download-btn" onclick="downloadResource('幼儿发展里程碑指南')">
                                    <i class="fas fa-download me-1"></i>下载
                                </button>
                                <div class="resource-rating">
                                    <span class="star" data-rating="1"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="2"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="3"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="4"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="5"><i class="fas fa-star"></i></span>
                                </div>
                            </div>
                            <div class="mt-2">
                                <span class="resource-tag">认知发展</span>
                                <span class="resource-tag">评估工具</span>
                            </div>
                        </div>
                        
                        <div class="resource-item">
                            <div class="resource-icon"><i class="fas fa-gamepad"></i></div>
                            <div class="resource-title">游戏活动设计手册</div>
                            <div class="resource-description">包含100+促进幼儿各领域发展的游戏活动方案，涵盖室内外活动、集体游戏和个别指导，配有详细实施步骤。</div>
                            <div class="resource-actions">
                                <button class="resource-download-btn" onclick="downloadResource('游戏活动设计手册')">
                                    <i class="fas fa-download me-1"></i>下载
                                </button>
                                <div class="resource-rating">
                                    <span class="star" data-rating="1"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="2"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="3"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="4"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="5"><i class="fas fa-star"></i></span>
                                </div>
                            </div>
                            <div class="mt-2">
                                <span class="resource-tag">游戏设计</span>
                                <span class="resource-tag">活动方案</span>
                            </div>
                        </div>
                        
                        <div class="resource-item">
                            <div class="resource-icon"><i class="fas fa-heart"></i></div>
                            <div class="resource-title">幼儿情绪管理策略</div>
                            <div class="resource-description">针对幼儿常见情绪问题，提供实用的应对策略和干预方法，帮助教师有效支持幼儿情绪健康发展。</div>
                            <div class="resource-actions">
                                <button class="resource-download-btn" onclick="downloadResource('幼儿情绪管理策略')">
                                    <i class="fas fa-download me-1"></i>下载
                                </button>
                                <div class="resource-rating">
                                    <span class="star" data-rating="1"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="2"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="3"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="4"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="5"><i class="fas fa-star"></i></span>
                                </div>
                            </div>
                            <div class="mt-2">
                                <span class="resource-tag">情绪管理</span>
                                <span class="resource-tag">心理健康</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="resource-category">
                    <h3 class="resource-category-title"><i class="fas fa-lightbulb me-2"></i>教学策略</h3>
                    <div class="resource-grid">
                        <div class="resource-item">
                            <div class="resource-icon"><i class="fas fa-comments"></i></div>
                            <div class="resource-title">语言发展促进策略</div>
                            <div class="resource-description">针对不同年龄段幼儿的语言发展特点，提供有效的语言环境创设和互动策略，促进幼儿语言能力发展。</div>
                            <div class="resource-actions">
                                <button class="resource-download-btn" onclick="downloadResource('语言发展促进策略')">
                                    <i class="fas fa-download me-1"></i>下载
                                </button>
                                <div class="resource-rating">
                                    <span class="star" data-rating="1"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="2"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="3"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="4"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="5"><i class="fas fa-star"></i></span>
                                </div>
                            </div>
                            <div class="mt-2">
                                <span class="resource-tag">语言发展</span>
                                <span class="resource-tag">教学策略</span>
                            </div>
                        </div>
                        
                        <div class="resource-item">
                            <div class="resource-icon"><i class="fas fa-puzzle-piece"></i></div>
                            <div class="resource-title">认知能力培养活动</div>
                            <div class="resource-description">包含观察、分类、比较、推理等认知能力培养的具体活动设计，适合在幼儿园日常教学中使用。</div>
                            <div class="resource-actions">
                                <button class="resource-download-btn" onclick="downloadResource('认知能力培养活动')">
                                    <i class="fas fa-download me-1"></i>下载
                                </button>
                                <div class="resource-rating">
                                    <span class="star" data-rating="1"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="2"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="3"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="4"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="5"><i class="fas fa-star"></i></span>
                                </div>
                            </div>
                            <div class="mt-2">
                                <span class="resource-tag">认知发展</span>
                                <span class="resource-tag">活动设计</span>
                            </div>
                        </div>
                        
                        <div class="resource-item">
                            <div class="resource-icon"><i class="fas fa-hands-helping"></i></div>
                            <div class="resource-title">社会交往能力培养</div>
                            <div class="resource-description">通过游戏和情境模拟，培养幼儿的合作、分享、轮流等社会交往技能，促进幼儿社会性发展。</div>
                            <div class="resource-actions">
                                <button class="resource-download-btn" onclick="downloadResource('社会交往能力培养')">
                                    <i class="fas fa-download me-1"></i>下载
                                </button>
                                <div class="resource-rating">
                                    <span class="star" data-rating="1"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="2"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="3"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="4"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="5"><i class="fas fa-star"></i></span>
                                </div>
                            </div>
                            <div class="mt-2">
                                <span class="resource-tag">社会交往</span>
                                <span class="resource-tag">合作能力</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="resource-category">
                    <h3 class="resource-category-title"><i class="fas fa-home me-2"></i>家园共育</h3>
                    <div class="resource-grid">
                        <div class="resource-item">
                            <div class="resource-icon"><i class="fas fa-user-friends"></i></div>
                            <div class="resource-title">家长沟通指南</div>
                            <div class="resource-description">提供与家长有效沟通的策略和技巧，包括家长会组织、日常沟通和家长参与活动的方法。</div>
                            <div class="resource-actions">
                                <button class="resource-download-btn" onclick="downloadResource('家长沟通指南')">
                                    <i class="fas fa-download me-1"></i>下载
                                </button>
                                <div class="resource-rating">
                                    <span class="star" data-rating="1"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="2"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="3"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="4"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="5"><i class="fas fa-star"></i></span>
                                </div>
                            </div>
                            <div class="mt-2">
                                <span class="resource-tag">家长沟通</span>
                                <span class="resource-tag">家园合作</span>
                            </div>
                        </div>
                        
                        <div class="resource-item">
                            <div class="resource-icon"><i class="fas fa-house-user"></i></div>
                            <div class="resource-title">家庭延伸活动</div>
                            <div class="resource-description">设计适合在家庭中进行的延伸活动，促进家园教育的一致性，帮助家长更好地支持幼儿发展。</div>
                            <div class="resource-actions">
                                <button class="resource-download-btn" onclick="downloadResource('家庭延伸活动')">
                                    <i class="fas fa-download me-1"></i>下载
                                </button>
                                <div class="resource-rating">
                                    <span class="star" data-rating="1"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="2"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="3"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="4"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="5"><i class="fas fa-star"></i></span>
                                </div>
                            </div>
                            <div class="mt-2">
                                <span class="resource-tag">家庭活动</span>
                                <span class="resource-tag">延伸学习</span>
                            </div>
                        </div>
                        
                        <div class="resource-item">
                            <div class="resource-icon"><i class="fas fa-calendar-alt"></i></div>
                            <div class="resource-title">家长工作坊方案</div>
                            <div class="resource-description">包含完整的家长工作坊实施方案，涵盖主题选择、活动设计和评估方法，促进家长教育能力提升。</div>
                            <div class="resource-actions">
                                <button class="resource-download-btn" onclick="downloadResource('家长工作坊方案')">
                                    <i class="fas fa-download me-1"></i>下载
                                </button>
                                <div class="resource-rating">
                                    <span class="star" data-rating="1"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="2"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="3"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="4"><i class="fas fa-star"></i></span>
                                    <span class="star" data-rating="5"><i class="fas fa-star"></i></span>
                                </div>
                            </div>
                            <div class="mt-2">
                                <span class="resource-tag">家长教育</span>
                                <span class="resource-tag">工作坊</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="text-center mt-4">
                    <!-- 修改：加载更多资源按钮添加点击事件 -->
                    <button class="btn btn-gradient" id="load-more-resources-btn"><i class="fas fa-redo me-2"></i>加载更多资源</button>
                </div>
            </div>
            
            <!-- 幼教论坛 -->
            <div id="forum-tab" class="tab-content d-none">
                <div class="row">
                    <div class="col-md-8">
                        <div class="card card-glow">
                            <div class="card-header">幼教论坛</div>
                            <div class="card-body">
                                <div id="forum-posts">
                                    <!-- 论坛帖子将通过JS动态生成 -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card card-glow">
                            <div class="card-header">发布新话题</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">话题标题</label>
                                    <input type="text" class="form-control input-glow" id="forum-title" placeholder="请输入话题标题">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">话题内容</label>
                                    <textarea class="form-control input-glow" id="forum-content" rows="5" placeholder="请输入话题内容"></textarea>
                                </div>
                                <button class="btn btn-gradient w-100 ripple" id="publish-topic-btn">发布话题</button>
                            </div>
                        </div>
                        
                        <div class="card card-glow mt-4">
                            <div class="card-header">热门话题</div>
                            <div class="card-body">
                                <div class="list-group" id="hot-topics">
                                    <!-- 热门话题将通过JS动态生成 -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 系统管理 -->
            <div id="admin-tab" class="tab-content d-none">
                <div class="admin-controls">
                    <h3 class="text-shadow">系统管理</h3>
                    <p class="mb-0">在这里您可以管理用户账号和系统设置</p>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card user-management-card card-glow">
                            <div class="card-header">教师管理</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">添加新教师</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control input-glow" id="new-teacher-username" placeholder="用户名">
                                        <input type="password" class="form-control input-glow" id="new-teacher-password" placeholder="密码">
                                        <select class="form-select input-glow" id="new-teacher-class">
                                            <option value="">选择班级</option>
                                            <!-- 班级选项将通过JS动态生成 -->
                                        </select>
                                        <button class="btn btn-gradient ripple" id="add-teacher-btn">添加</button>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-hover" id="teacher-table">
                                        <thead>
                                            <tr>
                                                <th>用户名</th>
                                                <th>班级</th>
                                                <th>状态</th>
                                                <th>操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- 教师数据将通过JS动态生成 -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card child-management-card card-glow">
                            <div class="card-header">幼儿管理</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">添加新幼儿</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control input-glow" id="new-child-name" placeholder="姓名">
                                        <select class="form-select input-glow" id="new-child-gender">
                                            <option value="男">男</option>
                                            <option value="女">女</option>
                                        </select>
                                        <input type="number" class="form-control input-glow" id="new-child-age" placeholder="月龄">
                                        <select class="form-select input-glow" id="new-child-class">
                                            <option value="">选择班级</option>
                                            <!-- 班级选项将通过JS动态生成 -->
                                        </select>
                                        <button class="btn btn-gradient ripple" id="add-child-admin-btn">添加</button>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-hover" id="child-admin-table">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>姓名</th>
                                                <th>班级</th>
                                                <th>操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- 幼儿数据将通过JS动态生成 -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="card parent-management-card card-glow">
                            <div class="card-header">家长账号管理</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">为幼儿添加家长账号</label>
                                    <div class="input-group">
                                        <select class="form-select input-glow" id="parent-child-select">
                                            <option value="">选择幼儿</option>
                                            <!-- 幼儿选项将通过JS动态生成 -->
                                        </select>
                                        <input type="text" class="form-control input-glow" id="new-parent-username" placeholder="用户名">
                                        <input type="password" class="form-control input-glow" id="new-parent-password" placeholder="密码">
                                        <button class="btn btn-gradient ripple" id="add-parent-btn">添加</button>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-hover" id="parent-table">
                                        <thead>
                                            <tr>
                                                <th>用户名</th>
                                                <th>对应幼儿</th>
                                                <th>状态</th>
                                                <th>操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- 家长数据将通过JS动态生成 -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card class-management-card card-glow">
                            <div class="card-header">班级管理</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">添加新班级</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control input-glow" id="new-class-name" placeholder="班级名称">
                                        <button class="btn btn-gradient ripple" id="add-class-btn">添加</button>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-hover" id="class-admin-table">
                                        <thead>
                                            <tr>
                                                <th>班级名称</th>
                                                <th>幼儿数量</th>
                                                <th>操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- 班级数据将通过JS动态生成 -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 主题切换按钮 -->
    <button class="theme-toggle btn btn-secondary ripple" id="theme-toggle">
        <i class="fas fa-moon"></i>
    </button>

    <!-- 浮动操作按钮 - 将问号图标改为信息图标 -->
    <button class="floating-btn btn btn-primary ripple" id="help-btn" data-bs-toggle="modal" data-bs-target="#helpModal">
        <i class="fas fa-info-circle"></i>
    </button>

    <!-- 帮助模态框 -->
    <div class="modal fade" id="helpModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">系统使用帮助</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6><i class="fas fa-chart-line me-2"></i>数据可视化</h6>
                            <p>系统提供多种图表展示幼儿发育数据，包括雷达图、趋势图和分布图。</p>
                            
                            <h6><i class="fas fa-exclamation-triangle me-2"></i>预警功能</h6>
                            <p>自动识别发育迟缓的幼儿，并提供个性化干预建议。</p>
                        </div>
                        <div class="col-md-6">
                            <h6><i class="fas fa-file-alt me-2"></i>报告生成</h6>
                            <p>可生成多种格式的发育评估报告，支持一键下载和打印。</p>
                            
                            <h6><i class="fas fa-users me-2"></i>多角色支持</h6>
                            <p>支持教师、园长、家长和管理员四种角色，权限分明。</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 幼儿详情模态框 -->
    <div class="modal fade" id="childDetailModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="childDetailModalTitle">幼儿详情</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="childDetailModalBody">
                    <!-- 幼儿详情内容将通过JS动态生成 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 评估模态框 -->
    <div class="modal fade" id="assessmentModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="assessmentModalTitle">幼儿发育评估</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="assessmentModalBody">
                    <!-- 评估表单内容将通过JS动态生成 -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary ripple" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary ripple" id="save-assessment-btn">保存评估</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 资源详情模态框 -->
    <div class="modal fade" id="resourceDetailModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="resourceDetailModalTitle">资源详情</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="resourceDetailModalBody">
                    <!-- 资源详情内容将通过JS动态生成 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 脚本 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 基于Excel数据的真实幼儿信息
        const realChildrenData = [
            // 新生班数据
            { id: "C001", name: "杨珞恒", gender: "男", ageMonths: 29, class: "新生", dq: 78.5, level: "良好" },
            { id: "C002", name: "高浩晨", gender: "男", ageMonths: 48, class: "新生", dq: 82.3, level: "良好" },
            { id: "C003", name: "谈景阳", gender: "男", ageMonths: 36, class: "新生", dq: 72.1, level: "中等" },
            { id: "C004", name: "白志强", gender: "男", ageMonths: 60, class: "新生", dq: 88.7, level: "优秀" },
            { id: "C005", name: "杨安亿", gender: "男", ageMonths: 36, class: "新生", dq: 65.4, level: "待加强" },
            { id: "C006", name: "王悦欣", gender: "女", ageMonths: 46, class: "新生", dq: 91.2, level: "优秀" },
            { id: "C007", name: "阮宇轩", gender: "男", ageMonths: 53, class: "新生", dq: 79.8, level: "良好" },
            { id: "C008", name: "罗思成", gender: "男", ageMonths: 60, class: "新生", dq: 84.5, level: "良好" },
            { id: "C009", name: "袁梓琪", gender: "女", ageMonths: 36, class: "新生", dq: 58.9, level: "需要关注" },
            { id: "C010", name: "陈瑾汐", gender: "女", ageMonths: 35, class: "新生", dq: 86.3, level: "优秀" },
            
            // 中一班数据
            { id: "C011", name: "吉格文辉", gender: "男", ageMonths: 45, class: "中一班", dq: 76.2, level: "良好" },
            { id: "C012", name: "吴昕烨", gender: "男", ageMonths: 38, class: "中一班", dq: 81.5, level: "良好" },
            { id: "C013", name: "朱奕名", gender: "男", ageMonths: 47, class: "中一班", dq: 73.8, level: "中等" },
            { id: "C014", name: "林传程", gender: "男", ageMonths: 39, class: "中一班", dq: 85.1, level: "良好" },
            { id: "C015", name: "曾景瑞", gender: "男", ageMonths: 44, class: "中一班", dq: 79.3, level: "良好" },
            { id: "C016", name: "龚孙离", gender: "女", ageMonths: 40, class: "中一班", dq: 82.7, level: "良好" },
            { id: "C017", name: "杨奕辰", gender: "男", ageMonths: 43, class: "中一班", dq: 68.5, level: "中等" },
            { id: "C018", name: "胡靖一", gender: "男", ageMonths: 47, class: "中一班", dq: 84.9, level: "良好" },
            { id: "C019", name: "张歆然", gender: "女", ageMonths: 42, class: "中一班", dq: 76.8, level: "良好" },
            { id: "C020", name: "熊璟玥", gender: "女", ageMonths: 38, class: "中一班", dq: 81.2, level: "良好" },
            
            // 中二班数据
            { id: "C021", name: "李芸浠", gender: "女", ageMonths: 46, class: "中二班", dq: 79.5, level: "良好" },
            { id: "C022", name: "仝伟华", gender: "男", ageMonths: 36, class: "中二班", dq: 74.2, level: "中等" },
            { id: "C023", name: "张明玖", gender: "男", ageMonths: 50, class: "中二班", dq: 82.6, level: "良好" },
            { id: "C024", name: "黄佳俊", gender: "男", ageMonths: 46, class: "中二班", dq: 77.8, level: "良好" },
            { id: "C025", name: "赵牧野", gender: "男", ageMonths: 48, class: "中二班", dq: 71.4, level: "中等" },
            { id: "C026", name: "杨宸皓", gender: "男", ageMonths: 48, class: "中二班", dq: 69.8, level: "中等" },
            { id: "C027", name: "周明阳", gender: "男", ageMonths: 40, class: "中二班", dq: 75.3, level: "良好" },
            { id: "C028", name: "郑林毅", gender: "男", ageMonths: 46, class: "中二班", dq: 80.7, level: "良好" },
            { id: "C029", name: "金梦琳", gender: "女", ageMonths: 48, class: "中二班", dq: 83.1, level: "良好" },
            { id: "C030", name: "马舒涵", gender: "女", ageMonths: 48, class: "中二班", dq: 79.6, level: "良好" },
            
            // 大二班数据
            { id: "C031", name: "毛婧", gender: "女", ageMonths: 54, class: "大二班", dq: 76.8, level: "良好" },
            { id: "C032", name: "曲木行一", gender: "男", ageMonths: 54, class: "大二班", dq: 81.3, level: "良好" },
            { id: "C033", name: "郭婧依", gender: "女", ageMonths: 50, class: "大二班", dq: 78.5, level: "良好" },
            { id: "C034", name: "阿力么科扎", gender: "女", ageMonths: 58, class: "大二班", dq: 72.9, level: "中等" },
            { id: "C035", name: "刘依湉", gender: "女", ageMonths: 52, class: "大二班", dq: 80.2, level: "良好" },
            { id: "C036", name: "李梓恬", gender: "女", ageMonths: 52, class: "大二班", dq: 84.7, level: "良好" },
            { id: "C037", name: "黑嫫诗洛", gender: "女", ageMonths: 54, class: "大二班", dq: 77.4, level: "良好" },
            { id: "C038", name: "赵苡漠", gender: "男", ageMonths: 50, class: "大二班", dq: 73.6, level: "中等" },
            { id: "C039", name: "武沐雨然", gender: "女", ageMonths: 53, class: "大二班", dq: 79.8, level: "良好" },
            { id: "C040", name: "王玥伊", gender: "女", ageMonths: 58, class: "大二班", dq: 82.1, level: "良好" },
            
            // 大一班数据
            { id: "C041", name: "刘炜奕", gender: "男", ageMonths: 68, class: "大一班", dq: 85.3, level: "良好" },
            { id: "C042", name: "沈绍辰", gender: "男", ageMonths: 64, class: "大一班", dq: 78.6, level: "良好" },
            { id: "C043", name: "吉伍英才", gender: "男", ageMonths: 66, class: "大一班", dq: 81.9, level: "良好" },
            { id: "C044", name: "陈宇航", gender: "男", ageMonths: 69, class: "大一班", dq: 83.4, level: "良好" },
            { id: "C045", name: "杨怡然", gender: "女", ageMonths: 74, class: "大一班", dq: 79.2, level: "良好" },
            { id: "C046", name: "李华轩", gender: "男", ageMonths: 70, class: "大一班", dq: 76.8, level: "良好" },
            { id: "C047", name: "宋习琛", gender: "男", ageMonths: 63, class: "大一班", dq: 82.5, level: "良好" },
            { id: "C048", name: "陈家煜", gender: "男", ageMonths: 65, class: "大一班", dq: 77.9, level: "良好" },
            { id: "C049", name: "安雨阳", gender: "男", ageMonths: 72, class: "大一班", dq: 84.1, level: "良好" },
            { id: "C050", name: "李洪梓域", gender: "男", ageMonths: 70, class: "大一班", dq: 80.7, level: "良好" },
            
            // 月亮二班数据
            { id: "C051", name: "何泽宇", gender: "女", ageMonths: 60, class: "月亮二班", dq: 75.2, level: "良好" },
            { id: "C052", name: "唐雨晨", gender: "女", ageMonths: 60, class: "月亮二班", dq: 81.5, level: "良好" },
            { id: "C053", name: "鲁永炘", gender: "女", ageMonths: 60, class: "月亮二班", dq: 68.3, level: "中等" },
            { id: "C054", name: "罗逸泽", gender: "男", ageMonths: 62, class: "月亮二班", dq: 72.8, level: "中等" },
            { id: "C055", name: "石一宁", gender: "男", ageMonths: 64, class: "月亮二班", dq: 79.1, level: "良好" },
            
            // 月亮三班数据
            { id: "C056", name: "李媛", gender: "女", ageMonths: 60, class: "月亮三班", dq: 76.4, level: "良好" },
            { id: "C057", name: "黄亦辰", gender: "男", ageMonths: 62, class: "月亮三班", dq: 82.7, level: "良好" },
            { id: "C058", name: "王子义新", gender: "男", ageMonths: 60, class: "月亮三班", dq: 70.5, level: "中等" },
            { id: "C059", name: "宋皓谱", gender: "男", ageMonths: 65, class: "月亮三班", dq: 85.2, level: "优秀" },
            { id: "C060", name: "唐锦辉", gender: "男", ageMonths: 60, class: "月亮三班", dq: 78.9, level: "良好" },
            
            // 桔子二班数据
            { id: "C061", name: "胡昌昊", gender: "男", ageMonths: 59, class: "桔子二班", dq: 74.6, level: "良好" },
            { id: "C062", name: "周云熙", gender: "女", ageMonths: 60, class: "桔子二班", dq: 81.3, level: "良好" },
            { id: "C063", name: "熊苏媛", gender: "女", ageMonths: 59, class: "桔子二班", dq: 69.8, level: "中等" },
            { id: "C064", name: "陈陶子奕", gender: "男", ageMonths: 60, class: "桔子二班", dq: 77.2, level: "良好" },
            { id: "C065", name: "王梓慕", gender: "男", ageMonths: 59, class: "桔子二班", dq: 83.5, level: "良好" }
        ];

        // 基于Excel数据的评估信息
        const realAssessments = {
            "C001": [
                { domain: "大运动", score: 80, level: "良好" },
                { domain: "精细动作", score: 75, level: "良好" },
                { domain: "语言", score: 82, level: "良好" },
                { domain: "适应能力", score: 76, level: "良好" },
                { domain: "社会行为", score: 80, level: "良好" }
            ],
            "C005": [
                { domain: "大运动", score: 70, level: "中等" },
                { domain: "精细动作", score: 62, level: "待加强" },
                { domain: "语言", score: 68, level: "中等" },
                { domain: "适应能力", score: 60, level: "待加强" },
                { domain: "社会行为", score: 67, level: "中等" }
            ],
            "C009": [
                { domain: "大运动", score: 55, level: "需要关注" },
                { domain: "精细动作", score: 60, level: "待加强" },
                { domain: "语言", score: 52, level: "需要关注" },
                { domain: "适应能力", score: 58, level: "需要关注" },
                { domain: "社会行为", score: 62, level: "待加强" }
            ],
            "C017": [
                { domain: "大运动", score: 72, level: "中等" },
                { domain: "精细动作", score: 65, level: "中等" },
                { domain: "语言", score: 70, level: "中等" },
                { domain: "适应能力", score: 67, level: "中等" },
                { domain: "社会行为", score: 68, level: "中等" }
            ],
            "C025": [
                { domain: "大运动", score: 75, level: "良好" },
                { domain: "精细动作", score: 68, level: "中等" },
                { domain: "语言", score: 70, level: "中等" },
                { domain: "适应能力", score: 72, level: "中等" },
                { domain: "社会行为", score: 72, level: "中等" }
            ],
            "C034": [
                { domain: "大运动", score: 78, level: "良好" },
                { domain: "精细动作", score: 70, level: "中等" },
                { domain: "语言", score: 68, level: "中等" },
                { domain: "适应能力", score: 75, level: "良好" },
                { domain: "社会行为", score: 73, level: "中等" }
            ],
            "C053": [
                { domain: "大运动", score: 65, level: "中等" },
                { domain: "精细动作", score: 70, level: "中等" },
                { domain: "语言", score: 62, level: "待加强" },
                { domain: "适应能力", score: 68, level: "中等" },
                { domain: "社会行为", score: 66, level: "中等" }
            ],
            "C058": [
                { domain: "大运动", score: 72, level: "中等" },
                { domain: "精细动作", score: 68, level: "中等" },
                { domain: "语言", score: 65, level: "中等" },
                { domain: "适应能力", score: 70, level: "中等" },
                { domain: "社会行为", score: 67, level: "中等" }
            ],
            "C063": [
                { domain: "大运动", score: 75, level: "良好" },
                { domain: "精细动作", score: 65, level: "中等" },
                { domain: "语言", score: 62, level: "待加强" },
                { domain: "适应能力", score: 70, level: "中等" },
                { domain: "社会行为", score: 67, level: "中等" }
            ]
        };

        // 为所有幼儿生成评估数据
        realChildrenData.forEach(child => {
            if (!realAssessments[child.id]) {
                // 基于发育商生成各领域分数
                const baseScore = child.dq;
                realAssessments[child.id] = [
                    { 
                        domain: "大运动", 
                        score: Math.max(40, Math.min(100, baseScore + (Math.random() * 10 - 5))),
                        level: getLevelByScore(Math.max(40, Math.min(100, baseScore + (Math.random() * 10 - 5))))
                    },
                    { 
                        domain: "精细动作", 
                        score: Math.max(40, Math.min(100, baseScore + (Math.random() * 10 - 5))),
                        level: getLevelByScore(Math.max(40, Math.min(100, baseScore + (Math.random() * 10 - 5))))
                    },
                    { 
                        domain: "语言", 
                        score: Math.max(40, Math.min(100, baseScore + (Math.random() * 10 - 5))),
                        level: getLevelByScore(Math.max(40, Math.min(100, baseScore + (Math.random() * 10 - 5))))
                    },
                    { 
                        domain: "适应能力", 
                        score: Math.max(40, Math.min(100, baseScore + (Math.random() * 10 - 5))),
                        level: getLevelByScore(Math.max(40, Math.min(100, baseScore + (Math.random() * 10 - 5))))
                    },
                    { 
                        domain: "社会行为", 
                        score: Math.max(40, Math.min(100, baseScore + (Math.random() * 10 - 5))),
                        level: getLevelByScore(Math.max(40, Math.min(100, baseScore + (Math.random() * 10 - 5))))
                    }
                ];
            }
        });

        // 根据分数获取等级
        function getLevelByScore(score) {
            if (score >= 85) return "优秀";
            if (score >= 75) return "良好";
            if (score >= 65) return "中等";
            if (score >= 55) return "待加强";
            return "需要关注";
        }

        // 用户数据 - 添加disabled属性来标记被禁用的账号
        const users = {
            'teacher1': { password: '123456', role: 'teacher', class: '新生', disabled: false },
            'teacher2': { password: '123456', role: 'teacher', class: '中一班', disabled: false },
            'teacher3': { password: '123456', role: 'teacher', class: '中二班', disabled: false },
            'teacher4': { password: '123456', role: 'teacher', class: '大二班', disabled: false },
            'teacher5': { password: '123456', role: 'teacher', class: '大一班', disabled: false },
            'teacher6': { password: '123456', role: 'teacher', class: '月亮二班', disabled: false },
            'teacher7': { password: '123456', role: 'teacher', class: '月亮三班', disabled: false },
            'teacher8': { password: '123456', role: 'teacher', class: '桔子二班', disabled: false },
            'principal': { password: '123456', role: 'principal', class: 'all', disabled: false },
            'admin': { password: '123456', role: 'admin', class: 'all', disabled: false },
            'yljz': { password: '123456', role: 'parent', childId: 'C001', disabled: false },
            'ghcjz': { password: '123456', role: 'parent', childId: 'C002', disabled: false },
            'tjyjz': { password: '123456', role: 'parent', childId: 'C003', disabled: false },
            'bzqjz': { password: '123456', role: 'parent', childId: 'C004', disabled: false },
            'ayjz': { password: '123456', role: 'parent', childId: 'C005', disabled: false }
        };

        // 班级数据
        let classes = [...new Set(realChildrenData.map(child => child.class))];

        // 论坛数据
        let forumPosts = [
            {
                id: 1,
                author: "张老师",
                title: "如何帮助幼儿建立良好的情绪管理能力？",
                content: "最近发现班级里有几个孩子情绪波动较大，容易发脾气，大家有什么好的方法可以帮助他们建立情绪管理能力吗？",
                date: "2023-10-15 09:30",
                likes: 12,
                comments: 5,
                replies: [
                    { author: "李老师", content: "可以试试情绪卡片游戏，帮助孩子识别和表达情绪。", date: "2023-10-15 10:20" },
                    { author: "王老师", content: "我们班用了情绪温度计的方法，效果不错。", date: "2023-10-15 11:05" }
                ]
            },
            {
                id: 2,
                author: "李老师",
                title: "分享一个促进幼儿语言发展的游戏活动",
                content: "今天在班级里尝试了一个'故事接龙'的游戏，孩子们非常喜欢，不仅锻炼了语言表达能力，还激发了想象力。具体活动方案如下...",
                date: "2023-10-14 16:45",
                likes: 23,
                comments: 8,
                replies: [
                    { author: "陈老师", content: "这个方法很好，我们班也试过，孩子们参与度很高。", date: "2023-10-14 17:30" }
                ]
            },
            {
                id: 3,
                author: "王老师",
                title: "关于幼儿精细动作发展的评估与训练",
                content: "精细动作发展对幼儿的认知和学习能力有重要影响。分享一些评估幼儿精细动作发展水平的方法和相应的训练活动...",
                date: "2023-10-13 11:20",
                likes: 18,
                comments: 6,
                replies: []
            }
        ];

        // 热门话题数据
        let hotTopics = [
            {
                id: 1,
                title: "如何应对幼儿分离焦虑？",
                content: "新学期开始，很多幼儿出现分离焦虑...",
                date: "3天前",
                views: 256,
                comments: 34
            },
            {
                id: 2,
                title: "幼儿挑食问题的解决策略",
                content: "分享一些应对幼儿挑食的有效方法...",
                date: "5天前",
                views: 189,
                comments: 27
            },
            {
                id: 3,
                title: "户外活动安全注意事项",
                content: "确保幼儿户外活动安全的要点...",
                date: "1周前",
                views: 312,
                comments: 41
            }
        ];

        // 当前用户信息
        let currentUser = null;

        // 初始化函数
        document.addEventListener('DOMContentLoaded', function() {
            // 登录按钮事件
            document.getElementById('login-btn').addEventListener('click', login);
            
            // 退出按钮事件
            document.getElementById('logout-btn').addEventListener('click', logout);
            
            // 导航栏切换
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    switchTab(this.getAttribute('data-tab'));
                });
            });
            
            // 班级筛选
            document.getElementById('class-filter').addEventListener('change', filterChildrenByClass);
            
            // 评估班级选择
            document.getElementById('assessment-class-select').addEventListener('change', updateAssessmentChildSelect);
            
            // 加载评估数据
            document.getElementById('load-assessment-btn').addEventListener('click', loadAssessmentData);
            
            // 生成报告
            document.getElementById('generate-report-btn').addEventListener('click', generateReport);
            
            // 下载报告
            document.getElementById('download-report-btn').addEventListener('click', downloadReport);
            
            // 主题切换
            document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
            
            // 添加幼儿按钮
            document.getElementById('add-child-btn').addEventListener('click', addChild);
            
            // 保存评估按钮
            document.getElementById('save-assessment-btn').addEventListener('click', saveAssessment);
            
            // 测试账号点击事件
            document.querySelectorAll('.test-account').forEach(account => {
                account.addEventListener('click', function() {
                    const username = this.getAttribute('data-username');
                    const password = this.getAttribute('data-password');
                    document.getElementById('username').value = username;
                    document.getElementById('password').value = password;
                    showNotification(`已自动填充账号: ${username}`, 'info');
                });
            });
            
            // 发布话题按钮
            document.getElementById('publish-topic-btn').addEventListener('click', publishTopic);
            
            // 管理员功能按钮
            document.getElementById('add-teacher-btn').addEventListener('click', addTeacher);
            document.getElementById('add-child-admin-btn').addEventListener('click', addChildAdmin);
            document.getElementById('add-parent-btn').addEventListener('click', addParent);
            document.getElementById('add-class-btn').addEventListener('click', addClass);
            
            // 修改：教育资源分类筛选
            document.getElementById('resource-category-filter').addEventListener('change', function() {
                filterResources(this.value);
            });
            
            // 修改：加载更多资源按钮
            document.getElementById('load-more-resources-btn').addEventListener('click', loadMoreResources);
            
            // 修改：为所有资源评分星星添加点击事件
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('star') || e.target.parentElement.classList.contains('star')) {
                    const star = e.target.classList.contains('star') ? e.target : e.target.parentElement;
                    const rating = parseInt(star.getAttribute('data-rating'));
                    rateResource(star, rating);
                }
            });
            
            // 修改：为资源卡片添加点击事件，但不包括下载和评分按钮区域
            document.addEventListener('click', function(e) {
                if (e.target.closest('.resource-item') && 
                    !e.target.closest('.resource-actions') && 
                    !e.target.closest('.resource-download-btn') && 
                    !e.target.closest('.resource-rating')) {
                    const resourceItem = e.target.closest('.resource-item');
                    const resourceTitle = resourceItem.querySelector('.resource-title').textContent;
                    showResourceDetail(resourceTitle);
                }
            });
            
            // 初始化班级选择框
            initializeClassSelects();
            
            // 初始化示例数据
            initializeSampleData();
            
            // 显示欢迎动画
            showWelcomeAnimation();
        });

        // 显示欢迎动画
        function showWelcomeAnimation() {
            const title = document.querySelector('.login-header h1');
            title.classList.add('typing-effect');
        }

        // 显示通知
        function showNotification(message, type = 'info') {
            const notificationArea = document.getElementById('notification-area');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="d-flex align-items-center">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} me-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            notificationArea.appendChild(notification);
            
            // 显示通知
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            // 自动隐藏通知
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // 登录函数
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (!username || !password) {
                showNotification('请输入用户名和密码', 'error');
                return;
            }
            
            // 检查账号是否被禁用
            if (users[username] && users[username].disabled) {
                showNotification('该账号已被禁用，请联系管理员', 'error');
                return;
            }
            
            // 显示加载状态
            document.getElementById('login-text').classList.add('d-none');
            document.getElementById('login-spinner').classList.remove('d-none');
            
            // 模拟网络延迟
            setTimeout(() => {
                if (users[username] && users[username].password === password) {
                    currentUser = {
                        username: username,
                        role: users[username].role,
                        class: users[username].class,
                        childId: users[username].childId
                    };
                    
                    // 切换到主应用
                    document.getElementById('login-page').classList.add('d-none');
                    document.getElementById('main-app').classList.remove('d-none');
                    
                    // 更新用户信息
                    let userDisplay = `${username} (${users[username].role})`;
                    if (users[username].role === 'teacher') {
                        userDisplay += ` - ${users[username].class}`;
                    } else if (users[username].role === 'parent') {
                        const child = realChildrenData.find(c => c.id === users[username].childId);
                        if (child) {
                            userDisplay += ` - ${child.name}的家长`;
                        }
                    }
                    document.getElementById('user-info').textContent = userDisplay;
                    
                    // 更新欢迎消息
                    document.getElementById('welcome-message').textContent = `欢迎回来，${username}！`;
                    document.getElementById('parent-welcome-message').textContent = `欢迎回来，${username}！`;
                    
                    // 根据用户角色初始化界面
                    initializeForUserRole();
                    
                    // 显示仪表盘
                    switchTab('dashboard');
                    
                    showNotification(`欢迎回来，${username}！`, 'success');
                } else {
                    showNotification('用户名或密码错误', 'error');
                    // 恢复登录按钮状态
                    document.getElementById('login-text').classList.remove('d-none');
                    document.getElementById('login-spinner').classList.add('d-none');
                }
            }, 1000);
        }

        // 退出函数
        function logout() {
            currentUser = null;
            document.getElementById('main-app').classList.add('d-none');
            document.getElementById('login-page').classList.remove('d-none');
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            
            // 恢复登录按钮状态
            document.getElementById('login-text').classList.remove('d-none');
            document.getElementById('login-spinner').classList.add('d-none');
            
            showNotification('您已成功退出系统', 'info');
        }

        // 切换标签页
        function switchTab(tabName) {
            // 隐藏所有标签页
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('d-none');
            });
            
            // 移除所有活动状态
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // 显示选中的标签页
            document.getElementById(`${tabName}-tab`).classList.remove('d-none');
            
            // 设置活动状态
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            // 根据标签页加载数据
            if (tabName === 'dashboard') {
                loadDashboardData();
            } else if (tabName === 'children') {
                loadChildrenData();
            } else if (tabName === 'assessment') {
                loadAssessmentData();
            } else if (tabName === 'reports') {
                loadReportsData();
            } else if (tabName === 'analytics') {
                loadAnalyticsData();
            } else if (tabName === 'forum') {
                loadForumData();
            } else if (tabName === 'admin') {
                loadAdminData();
            } else if (tabName === 'resources') {
                loadResourcesData();
            }
        }

        // 根据用户角色初始化界面
        function initializeForUserRole() {
            // 根据用户角色显示/隐藏特定功能
            if (currentUser.role === 'parent') {
                // 家长只能看到自己孩子的信息
                document.getElementById('children-nav').classList.add('d-none');
                document.getElementById('assessment-nav').classList.add('d-none');
                document.getElementById('analytics-nav').classList.add('d-none');
                document.getElementById('resources-nav').classList.add('d-none');
                document.getElementById('forum-nav').classList.add('d-none');
                document.getElementById('admin-nav').classList.add('d-none');
                
                // 显示家长专用仪表盘
                document.getElementById('parent-dashboard').classList.remove('d-none');
                document.getElementById('teacher-dashboard').classList.add('d-none');
            } else if (currentUser.role === 'teacher') {
                // 教师只能看到自己班级的信息
                document.getElementById('analytics-nav').classList.add('d-none');
                document.getElementById('admin-nav').classList.add('d-none');
                
                // 显示教师仪表盘
                document.getElementById('parent-dashboard').classList.add('d-none');
                document.getElementById('teacher-dashboard').classList.remove('d-none');
            } else if (currentUser.role === 'admin') {
                // 管理员可以看到所有功能
                document.getElementById('admin-nav').classList.remove('d-none');
                
                // 显示教师仪表盘
                document.getElementById('parent-dashboard').classList.add('d-none');
                document.getElementById('teacher-dashboard').classList.remove('d-none');
            } else if (currentUser.role === 'principal') {
                // 园长可以看到所有功能
                document.getElementById('admin-nav').classList.add('d-none');
                
                // 显示教师仪表盘
                document.getElementById('parent-dashboard').classList.add('d-none');
                document.getElementById('teacher-dashboard').classList.remove('d-none');
            }
        }

        // 初始化班级选择框
        function initializeClassSelects() {
            const classSelects = [
                document.getElementById('class-filter'),
                document.getElementById('assessment-class-select'),
                document.getElementById('new-teacher-class'),
                document.getElementById('new-child-class')
            ];
            
            classSelects.forEach(select => {
                if (select) {
                    // 清空现有选项
                    select.innerHTML = '';
                    
                    // 修改：为发育评估班级选择框添加"请选择班级"选项
                    if (select.id === 'assessment-class-select') {
                        const defaultOption = document.createElement('option');
                        defaultOption.value = '';
                        defaultOption.textContent = '请选择班级';
                        select.appendChild(defaultOption);
                    }
                    
                    // 添加班级选项
                    classes.forEach(className => {
                        const option = document.createElement('option');
                        option.value = className;
                        option.textContent = className;
                        select.appendChild(option);
                    });
                    
                    // 修改：为发育评估班级选择框添加默认选中当前用户班级
                    if (select.id === 'assessment-class-select' && currentUser && currentUser.class !== 'all') {
                        select.value = currentUser.class;
                        // 触发change事件以更新幼儿选择框
                        select.dispatchEvent(new Event('change'));
                    }
                }
            });
            
            // 初始化报告幼儿选择框
            const reportChildSelect = document.getElementById('report-child-select');
            if (reportChildSelect) {
                reportChildSelect.innerHTML = '<option value="">请选择幼儿</option>';
                
                realChildrenData.forEach(child => {
                    const option = document.createElement('option');
                    option.value = child.id;
                    option.textContent = `${child.name} (${child.class})`;
                    reportChildSelect.appendChild(option);
                });
            }
            
            // 初始化家长幼儿选择框
            const parentChildSelect = document.getElementById('parent-child-select');
            if (parentChildSelect) {
                parentChildSelect.innerHTML = '<option value="">请选择幼儿</option>';
                
                realChildrenData.forEach(child => {
                    const option = document.createElement('option');
                    option.value = child.id;
                    option.textContent = `${child.name} (${child.class})`;
                    parentChildSelect.appendChild(option);
                });
            }
        }

        // 初始化示例数据
        function initializeSampleData() {
            // 这里可以添加从后端API获取数据的逻辑
            console.log('初始化真实幼儿数据');
        }

        // 加载仪表盘数据
        function loadDashboardData() {
            if (currentUser.role === 'parent') {
                loadParentDashboard();
            } else {
                loadTeacherDashboard();
            }
        }

        // 加载家长仪表盘
        function loadParentDashboard() {
            const child = realChildrenData.find(c => c.id === currentUser.childId);
            if (!child) {
                showNotification('未找到幼儿信息', 'error');
                return;
            }
            
            // 更新孩子信息
            const childInfo = document.getElementById('parent-child-info');
            childInfo.innerHTML = `
                <table class="table table-bordered">
                    <tr><td width="30%">姓名</td><td>${child.name}</td></tr>
                    <tr><td>性别</td><td>${child.gender}</td></tr>
                    <tr><td>月龄</td><td>${child.ageMonths}个月</td></tr>
                    <tr><td>班级</td><td>${child.class}</td></tr>
                    <tr><td>发育商(DQ)</td><td>${child.dq.toFixed(1)}</td></tr>
                    <tr><td>发育水平</td><td><span class="development-level level-${getLevelClass(child.level)}">${child.level}</span></td></tr>
                </table>
            `;
            
            // 生成雷达图
            generateParentRadarChart(currentUser.childId);
            
            // 更新发育水平
            const developmentLevel = document.getElementById('parent-development-level');
            developmentLevel.innerHTML = `
                <h4 class="text-center">${child.level}</h4>
                <div class="progress mb-3">
                    <div class="progress-bar bg-success" role="progressbar" style="width: ${child.dq}%"></div>
                </div>
                <p class="text-center">发育商: ${child.dq.toFixed(1)}</p>
            `;
            
            // 生成教育建议
            const suggestions = document.getElementById('parent-suggestions');
            const assessments = realAssessments[child.id] || [];
            let weakDomains = assessments.filter(a => a.score < 65).map(a => a.domain);
            
            if (weakDomains.length === 0) {
                suggestions.innerHTML = `
                    <p>您的孩子发育情况良好，继续保持！</p>
                    <ul>
                        <li>继续提供丰富的语言环境，鼓励孩子表达</li>
                        <li>多参与户外活动，促进大运动发展</li>
                        <li>提供适当的社交机会，培养社会交往能力</li>
                    </ul>
                `;
            } else {
                suggestions.innerHTML = `
                    <p>您的孩子在以下领域需要加强：${weakDomains.join('、')}</p>
                    <ul>
                        <li>针对${weakDomains.join('、')}领域，提供专门的训练活动</li>
                        <li>与老师保持沟通，了解孩子在园表现</li>
                        <li>在家中创造相关领域的练习机会</li>
                    </ul>
                `;
            }
        }

        // 生成家长雷达图
        function generateParentRadarChart(childId) {
            const assessments = realAssessments[childId];
            if (!assessments) {
                showNotification('该幼儿暂无评估数据', 'error');
                return;
            }
            
            const radarCtx = document.getElementById('parent-radar-chart').getContext('2d');
            
            // 销毁现有图表
            if (window.parentRadarChart) {
                window.parentRadarChart.destroy();
            }
            
            // 修改：使用更美观的颜色
            window.parentRadarChart = new Chart(radarCtx, {
                type: 'radar',
                data: {
                    labels: assessments.map(a => a.domain),
                    datasets: [{
                        label: '能力得分',
                        data: assessments.map(a => a.score),
                        backgroundColor: 'rgba(74, 144, 226, 0.2)',
                        borderColor: 'rgba(74, 144, 226, 1)',
                        pointBackgroundColor: 'rgba(74, 144, 226, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(74, 144, 226, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        r: {
                            angleLines: {
                                display: true
                            },
                            suggestedMin: 0,
                            suggestedMax: 100,
                            ticks: {
                                stepSize: 20
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // 加载教师仪表盘
        function loadTeacherDashboard() {
            // 更新统计卡片
            let childrenToShow = realChildrenData;
            
            // 根据用户角色筛选数据
            if (currentUser.role === 'teacher') {
                childrenToShow = childrenToShow.filter(child => child.class === currentUser.class);
            }
            
            document.getElementById('total-children').textContent = childrenToShow.length;
            
            const userClasses = [...new Set(childrenToShow.map(child => child.class))];
            document.getElementById('total-classes').textContent = userClasses.length;
            
            document.getElementById('total-assessments').textContent = Object.keys(realAssessments).length * 5;
            
            // 计算预警人数（发育商<65）
            const warningCount = childrenToShow.filter(child => child.dq < 65).length;
            document.getElementById('warning-count').textContent = warningCount;
            
            // 生成预警列表
            const warningList = document.getElementById('warning-list');
            warningList.innerHTML = '';
            
            const warningChildren = childrenToShow.filter(child => child.dq < 65);
            
            // 增加预警幼儿数量 - 如果预警幼儿不足5个，添加一些接近预警线的幼儿
            let extendedWarningChildren = [...warningChildren];
            if (extendedWarningChildren.length < 5) {
                const nearWarningChildren = childrenToShow
                    .filter(child => child.dq >= 65 && child.dq < 70)
                    .slice(0, 5 - extendedWarningChildren.length);
                extendedWarningChildren = [...extendedWarningChildren, ...nearWarningChildren];
            }
            
            if (extendedWarningChildren.length === 0) {
                warningList.innerHTML = '<div class="alert alert-success">目前没有需要特别关注的幼儿</div>';
            } else {
                let tableHTML = `
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>姓名</th>
                                <th>班级</th>
                                <th>月龄</th>
                                <th>发育商</th>
                                <th>发育水平</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                extendedWarningChildren.forEach(child => {
                    const isNearWarning = child.dq >= 65 && child.dq < 70;
                    tableHTML += `
                        <tr class="${isNearWarning ? 'table-warning' : ''}">
                            <td>${child.name}</td>
                            <td>${child.class}</td>
                            <td>${child.ageMonths}个月</td>
                            <td>${child.dq.toFixed(1)}</td>
                            <td><span class="development-level level-${getLevelClass(child.level)}">${child.level}</span></td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary ripple" onclick="showChildDetails('${child.id}')">查看详情</button>
                            </td>
                        </tr>
                    `;
                });
                
                tableHTML += '</tbody></table>';
                warningList.innerHTML = tableHTML;
            }
            
            // 生成动态内容
            generateRecentActivities();
            
            // 生成图表
            generateDashboardCharts();
        }

        // 生成近期动态
        function generateRecentActivities() {
            const activitiesContainer = document.getElementById('recent-activities');
            activitiesContainer.innerHTML = '';
            
            const activities = [
                { icon: 'fas fa-user-plus', text: '新增幼儿评估记录 5 条', time: '2小时前' },
                { icon: 'fas fa-chart-line', text: '系统自动生成发育趋势分析报告', time: '4小时前' },
                { icon: 'fas fa-exclamation-triangle', text: '检测到 2 名幼儿需要关注', time: '1天前' },
                { icon: 'fas fa-file-alt', text: '教师张老师上传了新的教育资源', time: '2天前' },
                { icon: 'fas fa-users', text: '幼教论坛新增 3 个讨论话题', time: '3天前' }
            ];
            
            activities.forEach(activity => {
                const activityItem = document.createElement('div');
                activityItem.className = 'activity-item';
                activityItem.innerHTML = `
                    <div class="d-flex align-items-center">
                        <i class="${activity.icon} me-3 text-primary"></i>
                        <div class="flex-grow-1">
                            <p class="mb-0">${activity.text}</p>
                            <small class="text-muted">${activity.time}</small>
                        </div>
                    </div>
                `;
                activitiesContainer.appendChild(activityItem);
            });
        }

        // 生成仪表盘图表
        function generateDashboardCharts() {
            // 发育趋势图表
            const trendCtx = document.getElementById('development-trend-chart').getContext('2d');
            
            // 销毁现有图表
            if (window.trendChart) {
                window.trendChart.destroy();
            }
            
            window.trendChart = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月'],
                    datasets: [
                        {
                            label: '平均发育商',
                            data: [75, 78, 76, 80, 82, 85],
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: '预警阈值',
                            data: [65, 65, 65, 65, 65, 65],
                            borderColor: '#e74c3c',
                            borderDash: [5, 5],
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: '全园发育趋势'
                        }
                    },
                    scales: {
                        y: {
                            min: 50,
                            max: 100
                        }
                    }
                }
            });
            
            // 班级分布图表
            const classCtx = document.getElementById('class-distribution-chart').getContext('2d');
            
            // 计算每个班级的幼儿数量
            const classCounts = {};
            let childrenToShow = realChildrenData;
            
            // 根据用户角色筛选数据
            if (currentUser.role === 'teacher') {
                childrenToShow = childrenToShow.filter(child => child.class === currentUser.class);
            }
            
            childrenToShow.forEach(child => {
                classCounts[child.class] = (classCounts[child.class] || 0) + 1;
            });
            
            // 销毁现有图表
            if (window.classChart) {
                window.classChart.destroy();
            }
            
            const classColors = [
                '#3498db', '#2ecc71', '#f39c12', '#e74c3c',
                '#9b59b6', '#1abc9c', '#d35400', '#34495e'
            ];
            
            window.classChart = new Chart(classCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(classCounts),
                    datasets: [{
                        data: Object.values(classCounts),
                        backgroundColor: classColors
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
            
            // 生成班级分布图例
            const classLegend = document.getElementById('class-chart-legend');
            classLegend.innerHTML = '';
            
            Object.keys(classCounts).forEach((className, index) => {
                const legendItem = document.createElement('div');
                legendItem.className = 'class-chart-legend-item';
                legendItem.innerHTML = `
                    <div class="class-chart-color" style="background-color: ${classColors[index]}"></div>
                    <span>${className}: ${classCounts[className]}人</span>
                `;
                classLegend.appendChild(legendItem);
            });
        }

        // 显示幼儿详情
        function showChildDetails(childId) {
            const child = realChildrenData.find(c => c.id === childId);
            if (!child) {
                showNotification('未找到幼儿信息', 'error');
                return;
            }
            
            const assessments = realAssessments[child.id] || [];
            
            let detailsHTML = `
                <h4>${child.name} 的详细信息</h4>
                <table class="table table-bordered">
                    <tr><td width="30%">幼儿ID</td><td>${child.id}</td></tr>
                    <tr><td>姓名</td><td>${child.name}</td></tr>
                    <tr><td>性别</td><td>${child.gender}</td></tr>
                    <tr><td>月龄</td><td>${child.ageMonths}个月</td></tr>
                    <tr><td>班级</td><td>${child.class}</td></tr>
                    <tr><td>发育商(DQ)</td><td>${child.dq.toFixed(1)}</td></tr>
                    <tr><td>发育水平</td><td><span class="development-level level-${getLevelClass(child.level)}">${child.level}</span></td></tr>
                </table>
            `;
            
            if (assessments.length > 0) {
                detailsHTML += `
                    <h5 class="mt-4">能力评估详情</h5>
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>能力领域</th>
                                <th>得分</th>
                                <th>等级</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                assessments.forEach(assessment => {
                    detailsHTML += `
                        <tr>
                            <td>${assessment.domain}</td>
                            <td>${assessment.score}分</td>
                            <td><span class="development-level level-${getLevelClass(assessment.level)}">${assessment.level}</span></td>
                        </tr>
                    `;
                });
                
                detailsHTML += `
                        </tbody>
                    </table>
                `;
            }
            
            document.getElementById('childDetailModalTitle').textContent = `${child.name} 的详细信息`;
            document.getElementById('childDetailModalBody').innerHTML = detailsHTML;
            
            // 显示模态框
            const modal = new bootstrap.Modal(document.getElementById('childDetailModal'));
            modal.show();
        }

        // 显示评估表单
        function showAssessmentForm(childId) {
            const child = realChildrenData.find(c => c.id === childId);
            if (!child) {
                showNotification('未找到幼儿信息', 'error');
                return;
            }
            
            const assessments = realAssessments[child.id] || [];
            
            let formHTML = `
                <h4>${child.name} 的发育评估</h4>
                <p class="text-muted">请根据幼儿的实际表现进行评估</p>
                <form id="assessment-form">
                    <input type="hidden" id="assessment-child-id" value="${child.id}">
            `;
            
            const domains = ['大运动', '精细动作', '语言', '适应能力', '社会行为'];
            
            domains.forEach(domain => {
                const existingAssessment = assessments.find(a => a.domain === domain);
                const currentScore = existingAssessment ? existingAssessment.score : 70;
                
                formHTML += `
                    <div class="mb-3">
                        <label for="assessment-${domain}" class="form-label">${domain}能力</label>
                        <div class="d-flex align-items-center">
                            <input type="range" class="form-range flex-grow-1 me-3" id="assessment-${domain}" 
                                   min="0" max="100" value="${currentScore}" 
                                   oninput="document.getElementById('score-${domain}').textContent = this.value">
                            <span class="badge bg-primary" id="score-${domain}">${currentScore}</span>
                        </div>
                    </div>
                `;
            });
            
            formHTML += `</form>`;
            
            document.getElementById('assessmentModalTitle').textContent = `${child.name} 的发育评估`;
            document.getElementById('assessmentModalBody').innerHTML = formHTML;
            
            // 显示模态框
            const modal = new bootstrap.Modal(document.getElementById('assessmentModal'));
            modal.show();
        }

        // 保存评估
        function saveAssessment() {
            const childId = document.getElementById('assessment-child-id').value;
            const domains = ['大运动', '精细动作', '语言', '适应能力', '社会行为'];
            
            // 更新评估数据
            realAssessments[childId] = domains.map(domain => {
                const score = parseInt(document.getElementById(`assessment-${domain}`).value);
                return {
                    domain: domain,
                    score: score,
                    level: getLevelByScore(score)
                };
            });
            
            // 重新计算发育商
            const child = realChildrenData.find(c => c.id === childId);
            if (child) {
                const totalScore = realAssessments[childId].reduce((sum, assessment) => sum + assessment.score, 0);
                child.dq = totalScore / 5;
                child.level = getLevelByScore(child.dq);
            }
            
            // 关闭模态框
            const modal = bootstrap.Modal.getInstance(document.getElementById('assessmentModal'));
            modal.hide();
            
            showNotification('评估数据已保存', 'success');
            
            // 刷新相关页面
            if (document.getElementById('dashboard-tab').classList.contains('d-none') === false) {
                loadDashboardData();
            }
            if (document.getElementById('children-tab').classList.contains('d-none') === false) {
                loadChildrenData();
            }
        }

        // 加载幼儿数据
        function loadChildrenData() {
            const childrenTable = document.getElementById('children-table').querySelector('tbody');
            childrenTable.innerHTML = '';
            
            let childrenToShow = realChildrenData;
            
            // 根据用户角色筛选数据
            if (currentUser.role === 'teacher') {
                childrenToShow = childrenToShow.filter(child => child.class === currentUser.class);
            } else if (currentUser.role === 'parent') {
                childrenToShow = childrenToShow.filter(child => child.id === currentUser.childId);
            }
            
            // 填充表格
            childrenToShow.forEach(child => {
                const row = childrenTable.insertRow();
                
                // 根据发育水平设置CSS类
                let levelClass = 'level-medium';
                if (child.level === '优秀') levelClass = 'level-excellent';
                else if (child.level === '良好') levelClass = 'level-good';
                else if (child.level === '待加强') levelClass = 'level-need-improvement';
                else if (child.level === '需要关注') levelClass = 'level-need-attention';
                
                row.innerHTML = `
                    <td>${child.id}</td>
                    <td>${child.name}</td>
                    <td>${child.gender}</td>
                    <td>${child.ageMonths}个月</td>
                    <td>${child.class}</td>
                    <td>${child.dq.toFixed(1)}</td>
                    <td><span class="development-level ${levelClass}">${child.level}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary me-1 ripple" onclick="showChildDetails('${child.id}')">查看</button>
                        <button class="btn btn-sm btn-outline-success ripple" onclick="showAssessmentForm('${child.id}')">评估</button>
                    </td>
                `;
            });
        }

        // 根据班级筛选幼儿
        function filterChildrenByClass() {
            const selectedClass = document.getElementById('class-filter').value;
            const childrenTable = document.getElementById('children-table').querySelector('tbody');
            const rows = childrenTable.querySelectorAll('tr');
            
            rows.forEach(row => {
                const classCell = row.cells[4];
                if (selectedClass === 'all' || classCell.textContent === selectedClass) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // 更新评估幼儿选择框
        function updateAssessmentChildSelect() {
            const selectedClass = document.getElementById('assessment-class-select').value;
            const childSelect = document.getElementById('assessment-child-select');
            
            // 清空现有选项
            childSelect.innerHTML = '<option value="">请选择幼儿</option>';
            
            // 根据班级筛选幼儿
            let childrenToShow = realChildrenData;
            if (selectedClass !== '') {
                childrenToShow = childrenToShow.filter(child => child.class === selectedClass);
            }
            
            // 根据用户角色进一步筛选
            if (currentUser.role === 'teacher') {
                childrenToShow = childrenToShow.filter(child => child.class === currentUser.class);
            } else if (currentUser.role === 'parent') {
                childrenToShow = childrenToShow.filter(child => child.id === currentUser.childId);
            }
            
            // 添加选项
            childrenToShow.forEach(child => {
                const option = document.createElement('option');
                option.value = child.id;
                option.textContent = `${child.name} (${child.class})`;
                childSelect.appendChild(option);
            });
        }

        // 加载评估数据
        function loadAssessmentData() {
            const selectedChildId = document.getElementById('assessment-child-select').value;
            
            if (!selectedChildId) {
                showNotification('请选择幼儿', 'error');
                return;
            }
            
            // 查找幼儿信息
            const child = realChildrenData.find(c => c.id === selectedChildId);
            if (!child) {
                showNotification('未找到幼儿信息', 'error');
                return;
            }
            
            // 更新评估详情
            const assessmentDetails = document.getElementById('assessment-details');
            assessmentDetails.innerHTML = `
                <h5>${child.name} 的评估信息</h5>
                <p><strong>班级:</strong> ${child.class}</p>
                <p><strong>月龄:</strong> ${child.ageMonths}个月</p>
                <p><strong>发育商:</strong> ${child.dq.toFixed(1)}</p>
                <p><strong>发育水平:</strong> <span class="development-level level-${getLevelClass(child.level)}">${child.level}</span></p>
            `;
            
            // 生成雷达图
            generateRadarChart(selectedChildId);
            
            // 生成发育趋势图
            generateDevelopmentProgressChart(selectedChildId);
            
            showNotification(`已加载 ${child.name} 的评估数据`, 'success');
        }

        // 生成雷达图 - 美化版本
        function generateRadarChart(childId) {
            const assessments = realAssessments[childId];
            if (!assessments) {
                showNotification('该幼儿暂无评估数据', 'error');
                return;
            }
            
            const radarCtx = document.getElementById('radar-chart').getContext('2d');
            
            // 销毁现有图表
            if (window.radarChart) {
                window.radarChart.destroy();
            }
            
            // 定义丰富的颜色
            const backgroundColors = [
                'rgba(74, 144, 226, 0.2)',
                'rgba(108, 187, 89, 0.2)',
                'rgba(242, 201, 76, 0.2)',
                'rgba(235, 87, 87, 0.2)',
                'rgba(155, 89, 182, 0.2)'
            ];
            
            const borderColors = [
                'rgba(74, 144, 226, 1)',
                'rgba(108, 187, 89, 1)',
                'rgba(242, 201, 76, 1)',
                'rgba(235, 87, 87, 1)',
                'rgba(155, 89, 182, 1)'
            ];
            
            window.radarChart = new Chart(radarCtx, {
                type: 'radar',
                data: {
                    labels: assessments.map(a => a.domain),
                    datasets: [{
                        label: '能力得分',
                        data: assessments.map(a => a.score),
                        backgroundColor: 'rgba(74, 144, 226, 0.2)',
                        borderColor: 'rgba(74, 144, 226, 1)',
                        pointBackgroundColor: assessments.map((a, i) => borderColors[i % borderColors.length]),
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(74, 144, 226, 1)',
                        pointRadius: 6,
                        pointHoverRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        r: {
                            angleLines: {
                                display: true,
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            suggestedMin: 0,
                            suggestedMax: 100,
                            ticks: {
                                stepSize: 20,
                                backdropColor: 'rgba(255, 255, 255, 0.8)'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            pointLabels: {
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                color: '#333'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.7)',
                            titleFont: {
                                size: 14
                            },
                            bodyFont: {
                                size: 13
                            }
                        }
                    }
                }
            });
        }

        // 生成发育趋势图
        function generateDevelopmentProgressChart(childId) {
            const progressCtx = document.getElementById('development-progress-chart').getContext('2d');
            
            // 销毁现有图表
            if (window.progressChart) {
                window.progressChart.destroy();
            }
            
            window.progressChart = new Chart(progressCtx, {
                type: 'bar',
                data: {
                    labels: ['大运动', '精细动作', '语言', '适应能力', '社会行为'],
                    datasets: [{
                        label: '当前得分',
                        data: [80, 75, 82, 76, 80],
                        backgroundColor: '#3498db'
                    }, {
                        label: '上月得分',
                        data: [75, 70, 78, 72, 75],
                        backgroundColor: '#95a5a6'
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        // 加载报告数据
        function loadReportsData() {
            // 初始化报告幼儿选择框
            const reportChildSelect = document.getElementById('report-child-select');
            reportChildSelect.innerHTML = '<option value="">请选择幼儿</option>';
            
            let childrenToShow = realChildrenData;
            
            // 根据用户角色筛选数据
            if (currentUser.role === 'teacher') {
                childrenToShow = childrenToShow.filter(child => child.class === currentUser.class);
            } else if (currentUser.role === 'parent') {
                childrenToShow = childrenToShow.filter(child => child.id === currentUser.childId);
            }
            
            // 添加选项
            childrenToShow.forEach(child => {
                const option = document.createElement('option');
                option.value = child.id;
                option.textContent = `${child.name} (${child.class})`;
                reportChildSelect.appendChild(option);
            });
        }

        // 生成报告
        function generateReport() {
            const selectedChildId = document.getElementById('report-child-select').value;
            const reportType = document.getElementById('report-type').value;
            
            if (!selectedChildId) {
                showNotification('请选择幼儿', 'error');
                return;
            }
            
            // 查找幼儿信息
            const child = realChildrenData.find(c => c.id === selectedChildId);
            if (!child) {
                showNotification('未找到幼儿信息', 'error');
                return;
            }
            
            const assessments = realAssessments[child.id] || [];
            
            // 生成报告内容
            let reportHTML = '';
            
            if (reportType === 'text' || reportType === 'comprehensive') {
                reportHTML += `
                    <div class="printable-report">
                        <h2 class="text-center mb-4">幼儿发育评估报告</h2>
                        <hr>
                        <h4>一、基本信息</h4>
                        <table class="table table-bordered">
                            <tr><td width="30%">姓名</td><td>${child.name}</td></tr>
                            <tr><td>性别</td><td>${child.gender}</td></tr>
                            <tr><td>月龄</td><td>${child.ageMonths}个月</td></tr>
                            <tr><td>班级</td><td>${child.class}</td></tr>
                            <tr><td>发育商(DQ)</td><td>${child.dq.toFixed(1)}</td></tr>
                            <tr><td>发育水平</td><td>${child.level}</td></tr>
                        </table>
                        
                        <h4 class="mt-4">二、能力评估</h4>
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>能力领域</th>
                                    <th>得分</th>
                                    <th>等级</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                assessments.forEach(assessment => {
                    reportHTML += `
                        <tr>
                            <td>${assessment.domain}</td>
                            <td>${assessment.score}分</td>
                            <td>${assessment.level}</td>
                        </tr>
                    `;
                });
                
                reportHTML += `
                            </tbody>
                        </table>
                        
                        <h4 class="mt-4">三、教育建议</h4>
                        <ul>
                            <li>加强日常生活中的语言交流，鼓励幼儿表达自己的想法</li>
                            <li>提供丰富的操作材料，促进精细动作发展</li>
                            <li>组织集体游戏活动，培养社会交往能力</li>
                            <li>建立家园共育机制，定期沟通幼儿发展情况</li>
                        </ul>
                        
                        <div class="mt-5 text-end">
                            <p>报告生成时间: ${new Date().toLocaleString()}</p>
                        </div>
                    </div>
                `;
            }
            
            if (reportType === 'radar' || reportType === 'comprehensive') {
                if (reportType === 'comprehensive') {
                    reportHTML += '<hr class="my-4">';
                }
                
                reportHTML += `
                    <h4 class="${reportType === 'radar' ? '' : 'mt-4'}">能力雷达图</h4>
                    <div class="text-center">
                        <canvas id="report-radar-chart" width="400" height="300"></canvas>
                    </div>
                `;
            }
            
            // 更新报告预览
            document.getElementById('report-preview').innerHTML = reportHTML;
            
            // 如果包含雷达图，生成图表
            if (reportType === 'radar' || reportType === 'comprehensive') {
                setTimeout(() => {
                    const reportRadarCtx = document.getElementById('report-radar-chart').getContext('2d');
                    new Chart(reportRadarCtx, {
                        type: 'radar',
                        data: {
                            labels: assessments.map(a => a.domain),
                            datasets: [{
                                label: '能力得分',
                                data: assessments.map(a => a.score),
                                backgroundColor: 'rgba(74, 144, 226, 0.2)',
                                borderColor: 'rgba(74, 144, 226, 1)',
                                pointBackgroundColor: 'rgba(74, 144, 226, 1)',
                                pointBorderColor: '#fff',
                                pointHoverBackgroundColor: '#fff',
                                pointHoverBorderColor: 'rgba(74, 144, 226, 1)'
                            }]
                        },
                        options: {
                            responsive: true,
                            scales: {
                                r: {
                                    angleLines: {
                                        display: true
                                    },
                                    suggestedMin: 0,
                                    suggestedMax: 100
                                }
                            }
                        }
                    });
                }, 100);
            }
            
            showNotification(`已生成 ${child.name} 的${reportType === 'text' ? '文本报告' : reportType === 'radar' ? '雷达图' : '综合报告'}`, 'success');
        }

        // 下载报告
        function downloadReport() {
            const reportContent = document.getElementById('report-preview');
            
            if (!reportContent.innerHTML.trim()) {
                showNotification('请先生成报告', 'error');
                return;
            }
            
            html2canvas(reportContent).then(canvas => {
                const link = document.createElement('a');
                link.download = '幼儿发育评估报告.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                showNotification('报告下载成功', 'success');
            });
        }

        // 加载分析数据
        function loadAnalyticsData() {
            generateClassComparisonChart();
            generateDomainDistributionChart();
            loadWarningAnalysisTable();
        }

        // 生成班级对比图表
        function generateClassComparisonChart() {
            const comparisonCtx = document.getElementById('class-comparison-chart').getContext('2d');
            
            // 计算每个班级的平均发育商
            const classAverages = {};
            realChildrenData.forEach(child => {
                if (!classAverages[child.class]) {
                    classAverages[child.class] = { total: 0, count: 0 };
                }
                classAverages[child.class].total += child.dq;
                classAverages[child.class].count += 1;
            });
            
            const classes = Object.keys(classAverages);
            const averages = classes.map(cls => classAverages[cls].total / classAverages[cls].count);
            
            // 销毁现有图表
            if (window.comparisonChart) {
                window.comparisonChart.destroy();
            }
            
            window.comparisonChart = new Chart(comparisonCtx, {
                type: 'bar',
                data: {
                    labels: classes,
                    datasets: [{
                        label: '平均发育商',
                        data: averages,
                        backgroundColor: [
                            '#3498db', '#2ecc71', '#f39c12', '#e74c3c',
                            '#9b59b6', '#1abc9c', '#d35400', '#34495e'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        // 生成能力领域分布图表
        function generateDomainDistributionChart() {
            const domainCtx = document.getElementById('domain-distribution-chart').getContext('2d');
            
            // 计算各能力领域的平均分
            const domainAverages = {
                '大运动': 0,
                '精细动作': 0,
                '语言': 0,
                '适应能力': 0,
                '社会行为': 0
            };
            
            let domainCount = 0;
            
            Object.values(realAssessments).forEach(assessments => {
                assessments.forEach(assessment => {
                    domainAverages[assessment.domain] += assessment.score;
                    domainCount++;
                });
            });
            
            Object.keys(domainAverages).forEach(domain => {
                domainAverages[domain] = domainAverages[domain] / (domainCount / 5);
            });
            
            // 销毁现有图表
            if (window.domainChart) {
                window.domainChart.destroy();
            }
            
            window.domainChart = new Chart(domainCtx, {
                type: 'polarArea',
                data: {
                    labels: Object.keys(domainAverages),
                    datasets: [{
                        data: Object.values(domainAverages),
                        backgroundColor: [
                            'rgba(52, 152, 219, 0.7)',
                            'rgba(46, 204, 113, 0.7)',
                            'rgba(243, 156, 18, 0.7)',
                            'rgba(231, 76, 60, 0.7)',
                            'rgba(155, 89, 182, 0.7)'
                        ]
                    }]
                },
                options: {
                    responsive: true
                }
            });
        }

        // 加载预警分析表
        function loadWarningAnalysisTable() {
            const warningTable = document.getElementById('warning-analysis-table').querySelector('tbody');
            warningTable.innerHTML = '';
            
            const warningChildren = realChildrenData.filter(child => child.dq < 65);
            
            warningChildren.forEach(child => {
                const row = warningTable.insertRow();
                
                // 获取薄弱领域
                const assessments = realAssessments[child.id] || [];
                const weakDomains = assessments
                    .filter(a => a.score < 65)
                    .map(a => a.domain)
                    .join(', ');
                
                row.innerHTML = `
                    <td>${child.name}</td>
                    <td>${child.class}</td>
                    <td>${child.ageMonths}个月</td>
                    <td>${child.dq.toFixed(1)}</td>
                    <td><span class="development-level level-need-attention">${child.level}</span></td>
                    <td>${weakDomains || '暂无数据'}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary ripple" onclick="showChildDetails('${child.id}')">查看建议</button>
                    </td>
                `;
            });
        }

        // 显示资源详情
        function showResourceDetail(resourceName) {
            let resourceContent = '';
            
            switch(resourceName) {
                case '幼儿发展里程碑指南':
                    resourceContent = `
                        <h4>幼儿发展里程碑指南</h4>
                        <p>本指南详细介绍了0-6岁幼儿在各个发展领域的关键里程碑和评估标准，帮助教师和家长科学评估幼儿发展水平。</p>
                        <h5>主要内容包括：</h5>
                        <ul>
                            <li>0-3岁婴幼儿发展里程碑</li>
                            <li>3-6岁幼儿发展评估标准</li>
                            <li>各年龄段发展特点与指导建议</li>
                            <li>常见发展问题识别与干预</li>
                        </ul>
                        <p>本指南基于国内外权威研究成果编制，适用于幼儿园、早教机构和家庭使用。</p>
                    `;
                    break;
                case '游戏活动设计手册':
                    resourceContent = `
                        <h4>游戏活动设计手册</h4>
                        <p>本资源提供了促进幼儿各领域发展的游戏活动方案，涵盖认知、语言、动作、社会情感等多个方面。</p>
                        <h5>活动分类：</h5>
                        <ul>
                            <li>认知发展类游戏：拼图、分类、配对等</li>
                            <li>语言发展类游戏：故事接龙、角色扮演等</li>
                            <li>动作发展类游戏：平衡木、投掷、攀爬等</li>
                            <li>社会情感类游戏：合作游戏、情绪表达等</li>
                        </ul>
                        <p>每个活动都包含明确的目标、材料准备、实施步骤和评估要点，便于教师实际操作。</p>
                    `;
                    break;
                case '幼儿情绪管理策略':
                    resourceContent = `
                        <h4>幼儿情绪管理策略</h4>
                        <p>本资源聚焦幼儿情绪管理与心理健康培养，提供实用的策略和方法。</p>
                        <h5>主要内容：</h5>
                        <ul>
                            <li>幼儿情绪发展特点与规律</li>
                            <li>常见情绪问题识别与应对</li>
                            <li>心理健康教育活动设计</li>
                            <li>家园合作促进幼儿心理健康</li>
                        </ul>
                        <p>通过案例分析和实操指导，帮助教师有效支持幼儿心理健康发展。</p>
                    `;
                    break;
                case '语言发展促进策略':
                    resourceContent = `
                        <h4>语言发展促进策略</h4>
                        <p>针对不同年龄段幼儿的语言发展特点，提供有效的语言环境创设和互动策略，促进幼儿语言能力发展。</p>
                        <h5>核心内容：</h5>
                        <ul>
                            <li>0-3岁婴幼儿语言发展特点</li>
                            <li>3-6岁幼儿语言发展评估</li>
                            <li>语言环境创设与互动策略</li>
                            <li>语言发展游戏活动设计</li>
                        </ul>
                        <p>提供实用的教学工具和活动方案，帮助教师有效促进幼儿语言发展。</p>
                    `;
                    break;
                case '认知能力培养活动':
                    resourceContent = `
                        <h4>认知能力培养活动</h4>
                        <p>包含观察、分类、比较、推理等认知能力培养的具体活动设计，适合在幼儿园日常教学中使用。</p>
                        <h5>活动类型：</h5>
                        <ul>
                            <li>观察与分类活动</li>
                            <li>比较与排序活动</li>
                            <li>推理与解决问题活动</li>
                            <li>记忆与注意力训练活动</li>
                        </ul>
                        <p>每个活动都配有详细的教学指导和评估要点，便于教师实际操作。</p>
                    `;
                    break;
                case '社会交往能力培养':
                    resourceContent = `
                        <h4>社会交往能力培养</h4>
                        <p>通过游戏和情境模拟，培养幼儿的合作、分享、轮流等社会交往技能，促进幼儿社会性发展。</p>
                        <h5>培养重点：</h5>
                        <ul>
                            <li>合作与分享能力培养</li>
                            <li>情绪识别与表达</li>
                            <li>冲突解决能力培养</li>
                            <li>规则意识与自控能力</li>
                        </ul>
                        <p>提供实用的教学策略和活动方案，帮助教师有效促进幼儿社会性发展。</p>
                    `;
                    break;
                case '家长沟通指南':
                    resourceContent = `
                        <h4>家长沟通指南</h4>
                        <p>提供与家长有效沟通的策略和技巧，包括家长会组织、日常沟通和家长参与活动的方法。</p>
                        <h5>主要内容：</h5>
                        <ul>
                            <li>家长沟通的基本原则</li>
                            <li>家长会组织与实施</li>
                            <li>日常沟通技巧与策略</li>
                            <li>家长参与活动设计</li>
                        </ul>
                        <p>提供实用的沟通工具和模板，帮助教师建立积极的家园合作关系。</p>
                    `;
                    break;
                case '家庭延伸活动':
                    resourceContent = `
                        <h4>家庭延伸活动</h4>
                        <p>设计适合在家庭中进行的延伸活动，促进家园教育的一致性，帮助家长更好地支持幼儿发展。</p>
                        <h5>活动类型：</h5>
                        <ul>
                            <li>语言发展家庭活动</li>
                            <li>认知发展家庭活动</li>
                            <li>动作发展家庭活动</li>
                            <li>社会情感家庭活动</li>
                        </ul>
                        <p>每个活动都配有详细的实施指导和家长提示，便于家长实际操作。</p>
                    `;
                    break;
                case '家长工作坊方案':
                    resourceContent = `
                        <h4>家长工作坊方案</h4>
                        <p>包含完整的家长工作坊实施方案，涵盖主题选择、活动设计和评估方法，促进家长教育能力提升。</p>
                        <h5>工作坊主题：</h5>
                        <ul>
                            <li>幼儿发展特点与规律</li>
                            <li>家庭教育策略与方法</li>
                            <li>亲子互动技巧</li>
                            <li>家园合作共育</li>
                        </ul>
                        <p>提供完整的工作坊实施方案和材料，帮助教师有效组织家长教育活动。</p>
                    `;
                    break;
                default:
                    resourceContent = `<p>资源详情正在更新中...</p>`;
            }
            
            document.getElementById('resourceDetailModalTitle').textContent = resourceName;
            document.getElementById('resourceDetailModalBody').innerHTML = resourceContent;
            
            // 显示模态框
            const modal = new bootstrap.Modal(document.getElementById('resourceDetailModal'));
            modal.show();
        }

        // 过滤资源
        function filterResources(category) {
            let message = '';
            switch(category) {
                case 'all':
                    message = '已显示所有教育资源';
                    break;
                case 'cognitive':
                    message = '已筛选认知发展相关资源';
                    break;
                case 'motor':
                    message = '已筛选动作发展相关资源';
                    break;
                case 'language':
                    message = '已筛选语言发展相关资源';
                    break;
                case 'social':
                    message = '已筛选社会情感相关资源';
                    break;
                default:
                    message = '已筛选指定分类资源';
            }
            showNotification(message, 'info');
        }

        // 加载更多资源
        function loadMoreResources() {
            showNotification('正在加载更多教育资源...', 'info');
            
            // 模拟加载延迟
            setTimeout(() => {
                showNotification('已成功加载更多教育资源', 'success');
            }, 1500);
        }

        // 加载教育资源数据
        function loadResourcesData() {
            // 初始化资源分类筛选
            document.getElementById('resource-category-filter').value = 'all';
        }

        // 下载资源
        function downloadResource(resourceName) {
            showNotification(`正在下载 ${resourceName}...`, 'info');
            
            // 模拟下载延迟
            setTimeout(() => {
                showNotification(`${resourceName} 下载成功`, 'success');
            }, 1500);
        }

        // 资源评分
        function rateResource(star, rating) {
            const stars = star.parentElement.querySelectorAll('.star');
            
            // 更新所有星星的状态
            stars.forEach((s, index) => {
                if (index < rating) {
                    s.classList.add('active');
                } else {
                    s.classList.remove('active');
                }
            });
            
            showNotification(`感谢您的评分！您给这个资源打了 ${rating} 星`, 'success');
        }

        // 加载论坛数据
        function loadForumData() {
            generateForumPosts();
            generateHotTopics();
        }

        // 生成论坛帖子
        function generateForumPosts() {
            const forumContainer = document.getElementById('forum-posts');
            forumContainer.innerHTML = '';
            
            forumPosts.forEach(post => {
                const postElement = document.createElement('div');
                postElement.className = 'forum-post';
                postElement.innerHTML = `
                    <div class="d-flex align-items-center mb-2">
                        <div class="avatar">${post.author.charAt(0)}</div>
                        <div>
                            <h6 class="mb-0">${post.author}</h6>
                            <small class="text-muted">${post.date}</small>
                        </div>
                    </div>
                    <h5>${post.title}</h5>
                    <p>${post.content}</p>
                    <div class="d-flex">
                        <button class="btn btn-sm btn-outline-primary me-2 ripple" onclick="likePost(${post.id})">
                            <i class="fas fa-thumbs-up me-1"></i>${post.likes}
                        </button>
                        <button class="btn btn-sm btn-outline-secondary me-2 ripple" onclick="toggleComments(${post.id})">
                            <i class="fas fa-comment me-1"></i>${post.comments}
                        </button>
                        <button class="btn btn-sm btn-outline-info ripple" onclick="sharePost(${post.id})">
                            <i class="fas fa-share me-1"></i>分享
                        </button>
                    </div>
                    <div id="comments-${post.id}" class="mt-3 d-none">
                        <div class="mb-3">
                            <textarea class="form-control input-glow" id="reply-${post.id}" rows="2" placeholder="请输入回复内容"></textarea>
                            <button class="btn btn-sm btn-primary mt-2 ripple" onclick="addReply(${post.id})">发表回复</button>
                        </div>
                        <div id="replies-${post.id}">
                            ${post.replies.map(reply => `
                                <div class="border-bottom pb-2 mb-2">
                                    <div class="d-flex align-items-center mb-1">
                                        <strong>${reply.author}</strong>
                                        <small class="text-muted ms-2">${reply.date}</small>
                                    </div>
                                    <p class="mb-0">${reply.content}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                forumContainer.appendChild(postElement);
            });
        }

        // 生成热门话题
        function generateHotTopics() {
            const hotTopicsContainer = document.getElementById('hot-topics');
            hotTopicsContainer.innerHTML = '';
            
            hotTopics.forEach(topic => {
                const topicElement = document.createElement('a');
                topicElement.href = '#';
                topicElement.className = 'list-group-item list-group-item-action ripple';
                topicElement.innerHTML = `
                    <div class="d-flex w-100 justify-content-between">
                        <h6 class="mb-1">${topic.title}</h6>
                        <small>${topic.date}</small>
                    </div>
                    <p class="mb-1">${topic.content}</p>
                    <small><i class="fas fa-eye me-1"></i>${topic.views} <i class="fas fa-comment ms-2 me-1"></i>${topic.comments}</small>
                `;
                topicElement.addEventListener('click', function(e) {
                    e.preventDefault();
                    showTopicDetail(topic.id);
                });
                hotTopicsContainer.appendChild(topicElement);
            });
        }

        // 点赞帖子
        function likePost(postId) {
            const post = forumPosts.find(p => p.id === postId);
            if (post) {
                post.likes++;
                generateForumPosts();
                showNotification('已点赞', 'success');
            }
        }

        // 切换评论显示
        function toggleComments(postId) {
            const commentsDiv = document.getElementById(`comments-${postId}`);
            if (commentsDiv.classList.contains('d-none')) {
                commentsDiv.classList.remove('d-none');
            } else {
                commentsDiv.classList.add('d-none');
            }
        }

        // 分享帖子
        function sharePost(postId) {
            showNotification('帖子链接已复制到剪贴板', 'info');
        }

        // 添加回复
        function addReply(postId) {
            const replyContent = document.getElementById(`reply-${postId}`).value;
            if (!replyContent.trim()) {
                showNotification('请输入回复内容', 'error');
                return;
            }
            
            const post = forumPosts.find(p => p.id === postId);
            if (post) {
                post.replies.push({
                    author: currentUser.username,
                    content: replyContent,
                    date: new Date().toLocaleString()
                });
                post.comments++;
                document.getElementById(`reply-${postId}`).value = '';
                generateForumPosts();
                showNotification('回复已发布', 'success');
            }
        }

        // 显示话题详情
        function showTopicDetail(topicId) {
            const topic = hotTopics.find(t => t.id === topicId);
            if (topic) {
                // 在实际应用中，这里应该跳转到话题详情页
                let content = '';
                switch(topicId) {
                    case 1:
                        content = `
                            <h4>如何应对幼儿分离焦虑？</h4>
                            <p>分离焦虑是幼儿常见的情绪问题，特别是在新学期开始或环境变化时。以下是一些有效的应对策略：</p>
                            <ul>
                                <li>建立稳定的分离仪式，如拥抱、亲吻、说再见</li>
                                <li>提供过渡物品，如孩子喜欢的玩具或毯子</li>
                                <li>保持积极的态度，避免表现出焦虑情绪</li>
                                <li>逐步延长分离时间，让孩子慢慢适应</li>
                                <li>与老师密切合作，了解孩子在园表现</li>
                            </ul>
                            <p>通过这些方法，大多数幼儿能够在几周内适应分离。</p>
                        `;
                        break;
                    case 2:
                        content = `
                            <h4>幼儿挑食问题的解决策略</h4>
                            <p>挑食是幼儿期常见的问题，以下是一些有效的解决方法：</p>
                            <ul>
                                <li>提供多样化的食物选择，但不要强迫进食</li>
                                <li>将食物制作成有趣的形状，增加吸引力</li>
                                <li>让孩子参与食物准备过程，增加兴趣</li>
                                <li>建立规律的进餐时间和环境</li>
                                <li>以身作则，展示健康的饮食习惯</li>
                            </ul>
                            <p>记住，耐心和一致性是解决挑食问题的关键。</p>
                        `;
                        break;
                    case 3:
                        content = `
                            <h4>户外活动安全注意事项</h4>
                            <p>确保幼儿户外活动安全是教师的重要职责：</p>
                            <ul>
                                <li>活动前检查场地和设备的安全性</li>
                                <li>确保有足够的成人监督</li>
                                <li>根据天气情况调整活动安排</li>
                                <li>教导幼儿基本的安全规则</li>
                                <li>准备急救用品和应急预案</li>
                            </ul>
                            <p>通过充分的准备和监督，可以最大限度地确保幼儿户外活动的安全。</p>
                        `;
                        break;
                    default:
                        content = `<p>话题详情正在加载中...</p>`;
                }
                
                document.getElementById('resourceDetailModalTitle').textContent = topic.title;
                document.getElementById('resourceDetailModalBody').innerHTML = content;
                
                // 显示模态框
                const modal = new bootstrap.Modal(document.getElementById('resourceDetailModal'));
                modal.show();
            }
        }

        // 发布话题
        function publishTopic() {
            const title = document.getElementById('forum-title').value;
            const content = document.getElementById('forum-content').value;
            
            if (!title.trim() || !content.trim()) {
                showNotification('请输入话题标题和内容', 'error');
                return;
            }
            
            const newTopic = {
                id: forumPosts.length + 1,
                author: currentUser.username,
                title: title,
                content: content,
                date: new Date().toLocaleString(),
                likes: 0,
                comments: 0,
                replies: []
            };
            
            forumPosts.unshift(newTopic);
            document.getElementById('forum-title').value = '';
            document.getElementById('forum-content').value = '';
            generateForumPosts();
            showNotification('话题发布成功', 'success');
        }

        // 添加幼儿
        function addChild() {
            showNotification('添加幼儿功能开发中...', 'info');
        }

        // 切换主题
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const themeIcon = document.querySelector('#theme-toggle i');
            
            if (document.body.classList.contains('dark-mode')) {
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun');
                showNotification('已切换到深色模式', 'info');
            } else {
                themeIcon.classList.remove('fa-sun');
                themeIcon.classList.add('fa-moon');
                showNotification('已切换到浅色模式', 'info');
            }
        }

        // 获取发育水平对应的CSS类
        function getLevelClass(level) {
            switch(level) {
                case '优秀': return 'excellent';
                case '良好': return 'good';
                case '中等': return 'medium';
                case '待加强': return 'need-improvement';
                case '需要关注': return 'need-attention';
                default: return 'medium';
            }
        }

        // 管理员功能
        function loadAdminData() {
            loadTeacherTable();
            loadChildAdminTable();
            loadParentTable();
            loadClassAdminTable();
        }

        // 加载教师表格
        function loadTeacherTable() {
            const teacherTable = document.getElementById('teacher-table').querySelector('tbody');
            teacherTable.innerHTML = '';
            
            Object.keys(users).forEach(username => {
                const user = users[username];
                if (user.role === 'teacher') {
                    const row = teacherTable.insertRow();
                    const statusBadge = user.disabled ? 
                        '<span class="badge bg-danger">已禁用</span>' : 
                        '<span class="badge bg-success">正常</span>';
                    
                    row.innerHTML = `
                        <td>${username}</td>
                        <td>${user.class}</td>
                        <td>${statusBadge}</td>
                        <td>
                            <button class="btn btn-sm ${user.disabled ? 'btn-success' : 'btn-warning'} admin-action-btn" onclick="toggleUserStatus('${username}')">
                                ${user.disabled ? '启用' : '禁用'}
                            </button>
                            <button class="btn btn-sm btn-danger admin-action-btn" onclick="deleteUser('${username}')">删除</button>
                        </td>
                    `;
                }
            });
        }

        // 加载幼儿管理表格
        function loadChildAdminTable() {
            const childTable = document.getElementById('child-admin-table').querySelector('tbody');
            childTable.innerHTML = '';
            
            realChildrenData.forEach(child => {
                const row = childTable.insertRow();
                row.innerHTML = `
                    <td>${child.id}</td>
                    <td>${child.name}</td>
                    <td><span class="class-badge primary">${child.class}</span></td>
                    <td>
                        <button class="btn btn-sm btn-danger admin-action-btn" onclick="deleteChild('${child.id}')">删除</button>
                    </td>
                `;
            });
        }

        // 加载家长表格
        function loadParentTable() {
            const parentTable = document.getElementById('parent-table').querySelector('tbody');
            parentTable.innerHTML = '';
            
            Object.keys(users).forEach(username => {
                const user = users[username];
                if (user.role === 'parent') {
                    const child = realChildrenData.find(c => c.id === user.childId);
                    const childName = child ? child.name : '未知';
                    const statusBadge = user.disabled ? 
                        '<span class="badge bg-danger">已禁用</span>' : 
                        '<span class="badge bg-success">正常</span>';
                    
                    const row = parentTable.insertRow();
                    row.innerHTML = `
                        <td>${username}</td>
                        <td>${childName}</td>
                        <td>${statusBadge}</td>
                        <td>
                            <button class="btn btn-sm ${user.disabled ? 'btn-success' : 'btn-warning'} admin-action-btn" onclick="toggleUserStatus('${username}')">
                                ${user.disabled ? '启用' : '禁用'}
                            </button>
                            <button class="btn btn-sm btn-danger admin-action-btn" onclick="deleteUser('${username}')">删除</button>
                        </td>
                    `;
                }
            });
        }

        // 加载班级管理表格
        function loadClassAdminTable() {
            const classTable = document.getElementById('class-admin-table').querySelector('tbody');
            classTable.innerHTML = '';
            
            classes.forEach(className => {
                const childCount = realChildrenData.filter(child => child.class === className).length;
                const row = classTable.insertRow();
                row.innerHTML = `
                    <td><span class="class-badge success">${className}</span></td>
                    <td>${childCount}人</td>
                    <td>
                        <button class="btn btn-sm btn-danger admin-action-btn" onclick="deleteClass('${className}')">删除</button>
                    </td>
                `;
            });
        }

        // 添加教师
        function addTeacher() {
            const username = document.getElementById('new-teacher-username').value;
            const password = document.getElementById('new-teacher-password').value;
            const teacherClass = document.getElementById('new-teacher-class').value;
            
            if (!username || !password || !teacherClass) {
                showNotification('请填写完整的教师信息', 'error');
                return;
            }
            
            if (users[username]) {
                showNotification('用户名已存在', 'error');
                return;
            }
            
            users[username] = {
                password: password,
                role: 'teacher',
                class: teacherClass,
                disabled: false
            };
            
            document.getElementById('new-teacher-username').value = '';
            document.getElementById('new-teacher-password').value = '';
            document.getElementById('new-teacher-class').value = '';
            
            loadTeacherTable();
            showNotification('教师添加成功', 'success');
        }

        // 添加幼儿（管理员）
        function addChildAdmin() {
            const name = document.getElementById('new-child-name').value;
            const gender = document.getElementById('new-child-gender').value;
            const age = document.getElementById('new-child-age').value;
            const childClass = document.getElementById('new-child-class').value;
            
            if (!name || !age || !childClass) {
                showNotification('请填写完整的幼儿信息', 'error');
                return;
            }
            
            const newId = 'C' + (realChildrenData.length + 1).toString().padStart(3, '0');
            
            realChildrenData.push({
                id: newId,
                name: name,
                gender: gender,
                ageMonths: parseInt(age),
                class: childClass,
                dq: 70 + Math.random() * 20, // 随机生成发育商
                level: '中等'
            });
            
            document.getElementById('new-child-name').value = '';
            document.getElementById('new-child-age').value = '';
            document.getElementById('new-child-class').value = '';
            
            loadChildAdminTable();
            showNotification('幼儿添加成功', 'success');
        }

        // 添加家长
        function addParent() {
            const childId = document.getElementById('parent-child-select').value;
            const username = document.getElementById('new-parent-username').value;
            const password = document.getElementById('new-parent-password').value;
            
            if (!childId || !username || !password) {
                showNotification('请填写完整的家长信息', 'error');
                return;
            }
            
            if (users[username]) {
                showNotification('用户名已存在', 'error');
                return;
            }
            
            users[username] = {
                password: password,
                role: 'parent',
                childId: childId,
                disabled: false
            };
            
            document.getElementById('parent-child-select').value = '';
            document.getElementById('new-parent-username').value = '';
            document.getElementById('new-parent-password').value = '';
            
            loadParentTable();
            showNotification('家长添加成功', 'success');
        }

        // 添加班级
        function addClass() {
            const className = document.getElementById('new-class-name').value;
            
            if (!className) {
                showNotification('请输入班级名称', 'error');
                return;
            }
            
            if (classes.includes(className)) {
                showNotification('班级已存在', 'error');
                return;
            }
            
            classes.push(className);
            document.getElementById('new-class-name').value = '';
            
            // 重新初始化班级选择框
            initializeClassSelects();
            loadClassAdminTable();
            showNotification('班级添加成功', 'success');
        }

        // 切换用户状态
        function toggleUserStatus(username) {
            if (confirm(`确定要${users[username].disabled ? '启用' : '禁用'}用户 ${username} 吗？`)) {
                users[username].disabled = !users[username].disabled;
                showNotification(`用户 ${username} 已${users[username].disabled ? '禁用' : '启用'}`, 'success');
                
                // 刷新表格
                if (currentUser.role === 'admin') {
                    loadTeacherTable();
                    loadParentTable();
                }
            }
        }

        // 删除用户
        function deleteUser(username) {
            if (confirm(`确定要删除用户 ${username} 吗？此操作不可恢复！`)) {
                delete users[username];
                showNotification(`用户 ${username} 已删除`, 'success');
                
                // 刷新表格
                if (currentUser.role === 'admin') {
                    loadTeacherTable();
                    loadParentTable();
                }
            }
        }

        // 删除幼儿
        function deleteChild(childId) {
            if (confirm('确定要删除这个幼儿吗？此操作不可恢复！')) {
                const index = realChildrenData.findIndex(child => child.id === childId);
                if (index !== -1) {
                    realChildrenData.splice(index, 1);
                    delete realAssessments[childId];
                    loadChildAdminTable();
                    showNotification('幼儿删除成功', 'success');
                }
            }
        }

        // 删除班级
        function deleteClass(className) {
            if (confirm(`确定要删除班级 ${className} 吗？此操作不可恢复！`)) {
                // 从班级列表中移除
                classes = classes.filter(cls => cls !== className);
                
                // 重新初始化班级选择框
                initializeClassSelects();
                loadClassAdminTable();
                showNotification('班级删除成功', 'success');
            }
        }
    </script>
</body>
</html>
